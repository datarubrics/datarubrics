{"id": "CVPR-2022-120", "page_num": 9, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"[1] Davide Abati, Angelo Porrello, Simone Calderara, and Rita Cucchiara. Latent space autoregression for novelty detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 481\u2013490, 2019.\\n\\n[2] Samet Akcay, Amir Atapour-Abarghouei, and Toby P. Breckon. Ganomaly: Semi-supervised anomaly detection via adversarial training. In C. V. Jawahar, Hongdong Li, Greg Mori, and Konrad Schindler, editors, Computer Vision\u2013ACCV 2018, pages 622\u2013637, Cham, 2019. Springer International Publishing.\\n\\n[3] Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger. Mvtec ad \u2013 a comprehensive real-world dataset for unsupervised anomaly detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2019.\\n\\n[4] Paul Bergmann, Michael Fauser, David Sattlegger, and Carsten Steger. Uninformed students: Student-teacher anomaly detection with discriminative latent embeddings. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2020.\\n\\n[5] Paul Bergmann, Sindy L\u00f6we, Michael Fauser, David Sattlegger, and Carsten Steger. Improving unsupervised defect segmentation by applying structural similarity to autoencoders, 2018.\\n\\n[6] Pengguang Chen, Shu Liu, Hengshuang Zhao, and Jiaya Jia. Distilling knowledge via knowledge review. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 5008\u20135017, 2021.\\n\\n[7] Niv Cohen and Yedid Hoshen. Sub-image anomaly detection with deep pyramid correspondences, 2020.\\n\\n[8] Thomas Defard, Aleksandr Setkov, Angelique Loesch, and Romaric Audigier. Padim: A patch distribution modeling framework for anomaly detection and localization. In International Conference on Pattern Recognition, pages 475\u2013489. Springer, 2021.\\n\\n[9] Chelsea Finn, Pieter Abbeel, and Sergey Levine. Model-agnostic meta-learning for fast adaptation of deep networks. In International Conference on Machine Learning, pages 1126\u20131135. PMLR, 2017.\\n\\n[10] Izhak Golan and Ran El-Yaniv. Deep anomaly detection using geometric transformations. In Proceedings of the 32nd International Conference on Neural Information Processing Systems, NIPS\u201918, page 9781\u20139791, Red Hook, NY, USA, 2018. Curran Associates Inc.\\n\\n[11] Dong Gong, Lingqiao Liu, Vuong Le, Budhaditya Saha, Moussa Reda Mansour, Svetha Venkatesh, and Anton van den Hengel. Memorizing normality to detect anomaly: Memory-augmented deep autoencoder for unsupervised anomaly detection. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), October 2019.\\n\\n[12] Ian J. Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron Courville, and Yoshua Bengio. Generative adversarial nets. In Proceedings of the 27th International Conference on Neural Information Processing Systems - Volume 2, NIPS'14, page 2672\u20132680, Cambridge, MA, USA, 2014. MIT Press.\\n\\n[13] Gregory Griffin, Alex Holub, and Pietro Perona. Caltech-256 object category dataset. 2007.\\n\\n[14] Kaiming He, Xiangyu Zhang, Shaoqing Ren, and Jian Sun. Deep residual learning for image recognition. In Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition (CVPR), June 2016.\\n\\n[15] Geoffrey Hinton, Oriol Vinyals, and Jeffrey Dean. Distilling the knowledge in a neural network. In NIPS Deep Learning and Representation Learning Workshop, 2015.\\n\\n[16] Jinlei Hou, Yingying Zhang, Qiaoyong Zhong, Di Xie, Shiliang Pu, and Hong Zhou. Divide-and-assemble: Learning block-wise memory for unsupervised anomaly detection. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), pages 8791\u20138800, October 2021.\\n\\n[17] Wenpeng Hu, Mengyu Wang, Qi Qin, Jinwen Ma, and Bing Liu. Hrn: A holistic approach to one class learning. In H. Larochelle, M. Ranzato, R. Hadsell, M. F. Balcan, and H. Lin, editors, Advances in Neural Information Processing Systems, volume 33, pages 19111\u201319124. Curran Associates, Inc., 2020.\\n\\n[18] Diederik P Kingma and Jimmy Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980, 2014.\\n\\n[19] Diederik P Kingma and Max Welling. Auto-encoding variational bayes, 2013.\\n\\n[20] Alex Krizhevsky. Learning multiple layers of features from tiny images, 2009.\\n\\n[21] Alex Krizhevsky, Ilya Sutskever, and Geoffrey E. Hinton. Imagenet classification with deep convolutional neural networks. In Proceedings of the 25th International Conference on Neural Information Processing Systems - Volume 1, NIPS'12, page 1097\u20131105, Red Hook, NY, USA, 2012. Curran Associates Inc.\\n\\n[22] Yann LeCun. The mnist database of handwritten digits, 1998.\\n\\n[23] Chun-Liang Li, Kihyuk Sohn, Jinsung Yoon, and Tomas Pfister. Cutpaste: Self-supervised learning for anomaly detection and localization. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 9664\u20139674, June 2021.\\n\\n[24] W. Liu, D. Lian W. Luo, and S. Gao. Future frame prediction for anomaly detection \u2013 a new baseline. In 2018 IEEE Conference on Computer Vision and Pattern Recognition (CVPR), 2018.\\n\\n[25] Paolo Napoletano, Flavio Piccoli, and Raimondo Schettini. Anomaly detection in nanofibrous materials by cnn-based self-similarity. Sensors, 18(1), 2018.\\n\\n[26] Hyunjong Park, Jongyoun Noh, and Bumsub Ham. Learning memory-guided normality for anomaly detection. In IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), June 2020.\\n\\n[27] Pramuditha Perera, Ramesh Nallapati, and Bing Xiang. Ocgan: One-class novelty detection using gans with constrained.\"}"}
{"id": "CVPR-2022-120", "page_num": 10, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"latent representations. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 2898\u20132906, 2019.\\n\\n[28] Masoud Pourreza, Bahram Mohammadi, Mostafa Khaki, Samir Bouindour, Hichem Snoussi, and Mohammad Sabokrou. G2d: generate to detect anomaly. In Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pages 2003\u20132012, 2021.\\n\\n[29] Tal Reiss, Niv Cohen, Liron Bergman, and Yedid Hoshen. Panda: Adapting pretrained features for anomaly detection and segmentation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 2806\u20132814, June 2021.\\n\\n[30] Oliver Rippel, Patrick Mertens, and Dorit Merhof. Modeling the distribution of normal data in pre-trained deep features for anomaly detection. In 2020 25th International Conference on Pattern Recognition (ICPR), pages 6726\u20136733, 2021.\\n\\n[31] Lukas Ruff, Robert Vandermeulen, Nico Goernitz, Lucas Deecke, Shoaib Ahmed Siddiqui, Alexander Binder, Emmanuel M\u00fcller, and Marius Kloft. Deep one-class classification. In Jennifer Dy and Andreas Krause, editors, Proceedings of the 35th International Conference on Machine Learning, volume 80 of Proceedings of Machine Learning Research, pages 4393\u20134402. PMLR, 10\u201315 Jul 2018.\\n\\n[32] Mohammadreza Salehi, Hossein Mirzaei, Dan Hendrycks, Yixuan Li, Mohammad Hossein Rohban, and Mohammad Sabokrou. A unified survey on anomaly, novelty, open-set, and out-of-distribution detection: Solutions and future challenges. arXiv preprint arXiv:2110.14051, 2021.\\n\\n[33] Mohammadreza Salehi, Niousha Sadjadi, Soroosh Baselizadeh, Mohammad H. Rohban, and Hamid R. Rabiee. Multiresolution knowledge distillation for anomaly detection. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 14902\u201314912, June 2021.\\n\\n[34] Thomas Schlegl, Philipp Seeb\u00f6ck, Sebastian M. Waldstein, Georg Langs, and Ursula Schmidt-Erfurth. f-anogan: Fast unsupervised anomaly detection with generative adversarial networks. Medical Image Analysis, 54:30\u201344, 2019.\\n\\n[35] Bernhard Sch\u00f6lkopf, John C Platt, John Shawe-Taylor, Alex J Smola, and Robert C Williamson. Estimating the support of a high-dimensional distribution. Neural computation, 13(7):1443\u20131471, 2001.\\n\\n[36] David MJ Tax and Robert PW Duin. Support vector data description. Machine learning, 54(1):45\u201366, 2004.\\n\\n[37] Frederick Tung and Greg Mori. Similarity-preserving knowledge distillation. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), October 2019.\\n\\n[38] Shashanka Venkataramanan, Kuan-Chuan Peng, Rajat Vikram Singh, and Abhijit Mahalanobis. Attention guided anomaly localization in images. In European Conference on Computer Vision, pages 485\u2013503. Springer, 2020.\\n\\n[39] Guodong Wang, Shumin Han, Errui Ding, and Di Huang. Student-teacher feature pyramid matching for anomaly detection, 2021.\\n\\n[40] Jhih-Ciang Wu, Ding-Jie Chen, Chiou-Shann Fuh, and Tyng-Luh Liu. Learning unsupervised metaformer for anomaly detection. In Proceedings of the IEEE/CVF International Conference on Computer Vision (ICCV), pages 4369\u20134378, October 2021.\\n\\n[41] Han Xiao, Kashif Rasul, and Roland Vollgraf. Fashion-mnist: a novel image dataset for benchmarking machine learning algorithms, 2017.\\n\\n[42] Xudong Yan, Huaidong Zhang, Xuemiao Xu, Xiaowei Hu, and Pheng-Ann Heng. Learning semantic context from normal samples for unsupervised anomaly detection. Proceedings of the AAAI Conference on Artificial Intelligence, 35(4):3110\u20133118, May 2021.\\n\\n[43] Jihun Yi and Sungroh Yoon. Patch svdd: Patch-level svdd for anomaly detection and segmentation. In Proceedings of the Asian Conference on Computer Vision (ACCV), November 2020.\\n\\n[44] Sergey Zagoruyko and Nikos Komodakis. Wide residual networks. In Edwin R. Hancock Richard C. Wilson and William A. P. Smith, editors, Proceedings of the British Machine Vision Conference (BMVC), pages 87.1\u201387.12. BMVA Press, September 2016.\\n\\n[45] Muhammad Zaigham Zaheer, Jin-ha Lee, Marcella Astrid, and Seung-Ik Lee. Old is gold: Redefining the adversarially learned one-class classifier training paradigm. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition, pages 14183\u201314193, 2020.\\n\\n[46] Vitjan Zavrtanik, Matej Kristan, and Danijel Sko\u010daj. Reconstruction by inpainting for visual anomaly detection. Pattern Recognition, 112:107706, 2021.\\n\\n[47] Matthew D. Zeiler, Dilip Krishnan, Graham W. Taylor, and Rob Fergus. Deconvolutional networks. In 2010 IEEE Computer Society Conference on Computer Vision and Pattern Recognition, pages 2528\u20132535, 2010.\\n\\n[48] Kang Zhou, Yuting Xiao, Jianlong Yang, Jun Cheng, Wen Liu, Weixin Luo, Zaiwang Gu, Jiang Liu, and Shenghua Gao. Encoding structure-texture relation with p-net for anomaly detection in retinal images. In Computer Vision\u2013ECCV 2020: 16th European Conference, Glasgow, UK, August 23\u201328, 2020, Proceedings, Part XX 16, pages 360\u2013377. Springer, 2020.\\n\\n[49] Jinguo Zhu, Shixiang Tang, Dapeng Chen, Shijie Yu, Yakun Liu, Mingzhe Rong, Aijun Yang, and Xiaohua Wang. Complementary relation contrastive distillation. In Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR), pages 9260\u20139269, June 2021.\\n\\n[50] David Zimmerer, Jens Petersen, Gregor K\u00f6hler, Paul J\u00e4ger, Peter Full, Tobias Ro\u00df, Tim Adler, Annika Reinke, Lena Maier-Hein, and Klaus Maier-Hein. Medical out-of-distribution analysis challenge 2021, Mar. 2021.\"}"}
{"id": "CVPR-2022-120", "page_num": 1, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"Anomaly Detection via Reverse Distillation from One-Class Embedding\\n\\nHanqiu Deng Xingyu Li\\nDepartment of Electrical and Computer Engineering, University of Alberta {hanqiu1, xingyu}@ualberta.ca\\n\\nAbstract\\nKnowledge distillation (KD) achieves promising results on the challenging problem of unsupervised anomaly detection (AD). The representation discrepancy of anomalies in the teacher-student (T-S) model provides essential evidence for AD. However, using similar or identical architectures to build the teacher and student models in previous studies hinders the diversity of anomalous representations. To tackle this problem, we propose a novel T-S model consisting of a teacher encoder and a student decoder and introduce a simple yet effective \u201creverse distillation\u201d paradigm accordingly. Instead of receiving raw images directly, the student network takes teacher model\u2019s one-class embedding as input and targets to restore the teacher\u2019s multi-scale representations. Inherently, knowledge distillation in this study starts from abstract, high-level presentations to low-level features. In addition, we introduce a trainable one-class bottleneck embedding (OCBE) module in our T-S model. The obtained compact embedding effectively preserves essential information on normal patterns, but abandons anomaly perturbations. Extensive experimentation on AD and one-class novelty detection benchmarks shows that our method surpasses SOTA performance, demonstrating our proposed approach\u2019s effectiveness and generalizability.\\n\\n1. Introduction\\nAnomaly detection (AD) refers to identifying and localizing anomalies with limited, even no, prior knowledge of abnormality. The wide applications of AD, such as industrial defect detection [3], medical out-of-distribution detection [50], and video surveillance [24], makes it a critical task as well as a spotlight. In the context of unsupervised AD, no prior information on anomalies is available. Instead, a set of normal samples is provided for reference. To tackle this problem, previous efforts attempt to construct various self-supervision tasks on those anomaly-free samples. These tasks include, but not limited to, sample reconstruction [2,5,11,16,26,34,38,48], pseudo-outlier augmentation [23, 42, 46], knowledge distillation [4, 33, 39], etc. In this study, we tackle the problem of unsupervised anomaly detection from the knowledge distillation-based point of view. In knowledge distillation (KD) [6, 15], knowledge is transferred within a teacher-student (T-S) pair. In the context of unsupervised AD, since the student experiences only normal samples during training, it is likely to generate discrepant representations from the teacher when a query is anomalous. This hypothesis forms the basis of KD-based methods for anomaly detection. However, this hypothesis is not always true in practice due to (1) the identical or similar architectures of the teacher and student networks (i.e., non-distinguishing filters [33]) and (2) the same data flow in the T-S model during knowledge transfer/distillation. Though the use of a smaller student network partially addresses this issue [33, 39], the weaker representation capability of shallow architectures hinders the model from precisely detecting and localizing anomalies.\\n\\nTo holistically address the issue mentioned above, we propose a new paradigm of knowledge distillation, namely Reverse Distillation, for anomaly detection. We use simple diagrams in Fig. 2 to highlight the systematic difference between conventional knowledge distillation and the proposed reverse distillation. First, unlike the conventional knowledge distillation framework where both teacher and student adopt the encoder structure, the T-S model in our approach consists of a teacher encoder and a student decoder. The student takes the teacher\u2019s one-class embedding as input and is trained to reconstruct the teacher\u2019s multi-scale representations.\"}"}
{"id": "CVPR-2022-120", "page_num": 2, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"Figure 2. T-S models and data flow in (a) conventional KD framework \\\\cite{6, 33} and (b) our Reverse Distillation paradigm. Reverse distillation consists of heterogeneous architectures: a teacher encoder and a student decoder. Second, instead of directly feeding the raw data to the T-S model simultaneously, the student decoder takes the low-dimensional embedding as input, targeting to mimic the teacher's behavior by restoring the teacher model's representations in different scales. From the regression perspective, our reverse distillation uses the student network to predict the representation of the teacher model. Therefore, \u201creverse\u201d here indicates both the reverse shapes of teacher encoder and student decoder and the distinct knowledge distillation order where high-level representation is first distilled, followed by low-level features. It is noteworthy that our reverse distillation presents two significant advantages:\\n\\ni) Non-similarity structure. In the proposed T-S model, one can consider the teacher encoder as a down-sampling filter and the student decoder as an up-sampling filter. The \u201creverse structures\u201d avoid the confusion caused by non-distinguishing filters \\\\cite{33} as we discussed above.\\n\\nii) Compactness embedding. The low-dimensional embedding fed to the student decoder acts as an information bottleneck for normal pattern restoration. Let\u2019s formulate anomaly features as perturbations on normal patterns. Then the compact embedding helps to prohibit the propagation of such unusual perturbations to the student model and thus boosts the T-S model\u2019s representation discrepancy on anomalies. Notably, traditional AE-based methods \\\\cite{5, 11, 16, 26} detect anomalies utilising pixel differences, whereas we perform discrimination with dense descriptive features. Deep features as region-aware descriptors provide more effective discriminative information than per-pixel in images.\\n\\nIn addition, since the compactness of the bottleneck embedding is vital for anomaly detection (as discussed above), we introduce a one-class bottleneck embedding (OCBE) module to condense the feature codes further. Our OCBE module consists of a multi-scale feature fusion (MFF) block and one-class embedding (OCE) block, both jointly optimized with the student decoder. Notably, the former aggregates low- and high-level features to construct a rich embedding for normal pattern reconstruction. The latter targets to retain essential information favorable for the student to decode out the teacher\u2019s response.\\n\\nWe perform extensive experiments on public benchmarks. The experimental results indicate that our reverse distillation paradigm achieves comparable performance with prior arts. The proposed OCBE module further improves the performance to a new state-of-the-art (SOTA) record. Our main contributions are summarized as follows:\\n\\n\u2022 We introduce a simple, yet effective Reverse Distillation paradigm for anomaly detection. The encoder-decoder structure and reverse knowledge distillation strategy holistically address the non-distinguishing filter problem in conventional KD models, boosting the T-S model\u2019s discrimination capability on anomalies.\\n\\n\u2022 We propose a one-class bottleneck embedding module to project the teacher\u2019s high-dimensional features to a compact one-class embedding space. This innovation facilitates retaining rich yet compact codes for anomaly-free representation restoration at the student.\\n\\n\u2022 We perform extensive experiments and show that our approach achieves new SOTA performance.\\n\\n2. Related Work\\n\\nThis section briefly reviews previous efforts on unsupervised anomaly detection. We will highlight the similarity and difference between the proposed method and prior arts.\\n\\nClassical anomaly detection methods focus on defining a compact closed one-class distribution using normal support vectors. The pioneer studies include one-class support vector machine (OC-SVM) \\\\cite{35} and support vector data description (SVDD) \\\\cite{36}. To cope with high-dimensional data, DeepSVDD \\\\cite{31} and PatchSVDD \\\\cite{43} estimate data representations through deep networks.\\n\\nAnother unsupervised AD prototype is the use of generative models, such as AutoEncoder (AE) \\\\cite{19} and Generative Adversarial Nets (GAN) \\\\cite{12}, for sample reconstruction. These methods rely on the hypothesis that generative models trained on normal samples only can successfully reconstruct anomaly-free regions, but fail for anomalous regions \\\\cite{2, 5, 34}. However, recent studies show that deep models generalize so well that even anomalous regions can be well-restored \\\\cite{46}. To address this issue, memory mechanism \\\\cite{11, 16, 26}, image masking strategy \\\\cite{42, 46} and pseudo-anomaly \\\\cite{28, 45} are incorporated in reconstruction-based methods. However, these methods still lack a strong discriminating ability for real-world anomaly detection \\\\cite{3, 5}. Recently, Metaformer (MF) \\\\cite{40} proposes the use of meta-learning \\\\cite{9} to bridge model adaptation and reconstruction gap for reconstruction-based approaches. Notably, the proposed reverse knowledge distillation also adopts the encoder-decoder architecture, but it\"}"}
{"id": "CVPR-2022-120", "page_num": 3, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"differs from construction-based methods in two-folds. First, the encoder in a generative model is jointly trained with the decoder, while our reverse distillation freezes a pre-trained model as the teacher. Second, instead of pixel-level reconstruction error, it performs anomaly detection on the semantic feature space.\\n\\nData augmentation strategy is also widely used. By adding pseudo anomalies in the provided anomaly-free samples, the unsupervised task is converted to a supervised learning task [23, 42, 46]. However, these approaches are prone to bias towards pseudo outliers and fail to detect a large variety of anomaly types. For example, CutPaste [23] generates pseudo outliers by adding small patches onto normal images and trains a model to detect these anomalous regions. Since the model focuses on detecting local features such as edge discontinuity and texture perturbations, it fails to detect and localize large defects and global structural anomalies as shown in Fig. 6.\\n\\nRecently, networks pre-trained on the large dataset are proven to be capable of extracting discriminative features for anomaly detection [7,8,23,25,29,30]. With a pre-trained model, memorizing its anomaly-free features helps to identify anomalous samples [7, 29]. The studies in [8, 30] show that using the Mahalanobis distance to measure the similarity between anomalies and anomaly-free features leads to accurate anomaly detection. Since these methods require memorizing all features from training samples, they are computationally expensive.\\n\\nKnowledge distillation from pre-trained models is another potential solution to anomaly detection. In the context of unsupervised AD, since the student model is exposed to anomaly-free samples in knowledge distillation, the T-S model is expected to generate discrepant features on anomalies in inference [4,33,39]. To further increase the discriminating capability of the T-S model on various types of abnormalities, different strategies are introduced. For instance, in order to capture multi-scale anomaly, US [4] ensembles several models trained on normal data at different scales, and MKD [33] propose to use multi-level features alignment. It should be noted that though the proposed method is also based on knowledge distillation, our reverse distillation is the first to adopt an encoder and a decoder to construct the T-S model. The heterogeneity of the teacher and student networks and reverse data flow in knowledge distillation distinguishes our method from prior arts.\\n\\n3. Our Approach\\n\\nProblem formulation:\\n\\nLet $I_t = \\\\{I_{t1}, ..., I_{tn}\\\\}$ be a set of available anomaly-free images and $I_q = \\\\{I_{q1}, ..., I_{qm}\\\\}$ be a query set containing both normal and abnormal samples. The goal is to train a model to recognize and localize anomalies in the query set. In the anomaly detection setting, normal samples in both $I_t$ and $I_q$ follow the same distribution. Out-of-distribution samples are considered anomalies.\\n\\nSystem overview:\\n\\nFig. 3 depicts the proposed reserve distillation framework for anomaly detection. Our reverse distillation framework consists of three modules: a fixed pre-trained teacher encoder $E$, a trainable one-class bottleneck embedding module, and a student decoder $D$. Given an input sample $I \\\\in I_t$, the teacher $E$ extracts multi-scale representations. We propose to train a student $D$ to restore the features from the bottleneck embedding. During testing/inference, the representation extracted by the teacher $E$ can capture abnormal, out-of-distribution features in anomalous samples. However, the student decoder $D$ fails to reconstruct these anomalous features from the corresponding embedding. The low similarity of anomalous representations in the proposed T-S model indicates a high abnormality score. We argue that the heterogeneous encoder and decoder structures and reverse knowledge distillation order contribute a lot to the discrepant representations of anomalies. In addition, the trainable OCBE module further condenses the multi-scale patterns into an extreme low-dimensional space for downstream normal representation reconstruction. This further improves feature discrepancy on anomalies in our T-S model, as abnormal representations generated by the teacher model are likely to be abandoned by OCBE. In the rest of this section, we first specify the reverse distillation paradigm. Then, we elaborate on the OCBE module. Finally, we describe anomaly detection and localization using reserve distillation.\\n\\n3.1. Reverse Distillation\\n\\nIn conventional KD, the student network adopts a similar or identical neural network to the teacher model, accepts raw data/images as input, and targets to match its feature activations to the teacher's [4, 33]. In the context of one-class distillation for unsupervised AD, the student model is expected to generate highly different representations from the teacher when the queries are anomalous samples [11, 26]. However, the activation discrepancy on anomalies vanishes sometimes, leading to anomaly detection failure. We argue that this issue is attributed to the similar architectures of the teacher and student nets and the same data flow during T-S knowledge transfer. To improve the T-S model's representation diversity on unknown, out-of-distribution samples, we propose a novel reverse distillation paradigm, where the T-S model adopts the encoder-decoder architecture and knowledge is distilled from teacher's deep layers to its early layers, i.e., high-level, semantic knowledge being transferred to the student first. To further facilitate the one-class distillation, we designed a trainable OCEB module to connect the teacher and student models (Sec. 3.2).\"}"}
{"id": "CVPR-2022-120", "page_num": 4, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"Figure 3. Overview of our reverse distillation framework for anomaly detection and localization. (a) Our model consists of a pre-trained teacher encoder $E$, a trainable one-class bottleneck embedding module (OCBE), and a student decoder $D$. We use a multi-scale feature fusion (MFF) block to ensemble low- and high-level features from $E$ and map them onto a compact code by one-class embedding (OCE) block. During training, the student $D$ learns to mimic the behavior of $E$ by minimizing the similarity loss $L$. (b) During inference, $E$ extracts the features truthfully, while $D$ outputs anomaly-free ones. A low similarity between the feature vectors at the corresponding position of $E$ and $D$ implies an abnormality. (c) The final prediction is calculated by the accumulation of multi-scale similarity maps $M$.\\n\\nTo match the intermediate representations of $E$, the architecture of student decoder $D$ is symmetrical but reversed compared to $E$. The reverse design facilitates eliminating the response of the student network to abnormalities, while the symmetry allows it to have the same representation dimension as the teacher network. For instance, when we take ResNet as the teacher model, the student $D$ consists of several residual-like decoding blocks for mirror symmetry. Specifically, the downsampling in ResNet is realized by a convolutional layer with a kernel size of 1 and a stride of 2 \\\\cite{ResNet}. The corresponding decoding block in the student $D$ adopts deconvolutional layers \\\\cite{Deconv}. More details on the student decoder design are given in Supplementary Material.\\n\\nIn our reverse distillation, the student decoder $D$ targets to mimic the behavior of the teacher encoder $E$ during training. In this work, we explore multi-scale feature-based distillation for anomaly detection. The motivation behind this is that shallow layers of a neural network extract local descriptors for low-level information (e.g., color, edge, texture, etc.), while deep layers have wider receptive fields, capable of characterizing regional/global semantic and structural information. That is, low similarity of low- and high-level features in the T-S model suggests local abnormalities and regional/global structural outliers, respectively.\\n\\nMathematically, let $\\\\phi$ indicates the projection from raw data $I$ to the one-class bottleneck embedding space, the paired activation correspondence in our T-S model is $\\\\{f_k^E = E_k(I), f_k^D = D_k(\\\\phi)\\\\}$, where $E_k$ and $D_k$ represent the $k$th encoding and decoding block in the teacher and student model, respectively. $f_k^E, f_k^D \\\\in \\\\mathbb{R}^{C_k \\\\times H_k \\\\times W_k}$, where $C_k$, $H_k$, and $W_k$ denote the number of channels, height and width of the $k$th layer activation tensor. For knowledge transfer in the T-S model, the cosine similarity is taken as the KD loss, as it is more precisely to capture the relation in both high-and low-dimensional information \\\\cite{Distillation}. Specifically, for feature tensors $f_k^E$ and $f_k^D$, we calculate their vector-wise cosine similarity loss along the channel axis and obtain a 2-D anomaly map $M_k$:\\n\\n$$M_k(h, w) = 1 - \\\\frac{(f_k^E(h, w))^T \\\\cdot (f_k^D(h, w))}{\\\\| f_k^E(h, w) \\\\| \\\\cdot \\\\| f_k^D(h, w) \\\\|}.$$ (1)\"}"}
{"id": "CVPR-2022-120", "page_num": 5, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A large value in $M_k$ indicates high anomaly in that location. Considering the multi-scale knowledge distillation, the scalar loss function for student's optimization is obtained by accumulating multi-scale anomaly maps:\\n\\n$$L_{KD} = \\\\sum_{k=1}^{K} \\\\frac{1}{H_k \\\\times W_k} \\\\sum_{h=1}^{H_k} \\\\sum_{w=1}^{W_k} M_k(h, w),$$\\n\\nwhere $K$ indicates the number of feature layers used in the experiment.\\n\\n3.2. One-Class Bottleneck Embedding\\n\\nSince the student model $D$ attempts to restore representations of a teacher model $E$ in our reverse knowledge distillation paradigm, one can directly feed the activation output of the last encoding block in backbone to $D$. However, this naive connection has two shortfalls. First, the teacher model in KD usually has a high capacity. Though the high-capacity model helps extract rich features, the obtained high-dimensional descriptors likely have a considerable redundancy. The high freedom and redundancy of representations are harmful to the student model to decode the essential anomaly-free features. Second, the activation of the last encoder block in backbone usually characterizes semantic and structural information of the input data. Due to the reverse order of knowledge distillation, directly feeding this high-level representation to the student decoder setting a challenge for low-level features reconstruction. Previous efforts on data reconstruction usually introduce skip paths to connect the encoder and decoder. However, this approach doesn't work in knowledge distillation, as the skip paths leak anomaly information to the student during inference.\\n\\nTo tackle the first shortfall above in one-class distillation, we introduce a trainable one-class embedding block to project the teacher model's high-dimensional representations into a low-dimensional space. Let's formulate anomaly features as perturbations on normal patterns. Then the compact embedding acts as an information bottleneck and helps to prohibit the propagation of unusual perturbations to the student model, therefore boosting the T-S model's representation discrepancy on anomalies. In this study, we adopt the 4th residual block of ResNet [14] as the one-class embedding block.\\n\\nTo address the problem on low-level feature restoration at decoder $D$, the MFF block concatenates multi-scale representations before one-class embedding. To achieve representation alignment in feature concatenation, we downsample the shallow features through one or more $3 \\\\times 3$ convolutional layers with stride of 2, followed by batch normalization and ReLU activation function. Then a $1 \\\\times 1$ convolutional layer with stride of 1 and a batch normalization with relu activation are exploited for a rich yet compact feature.\\n\\nWe depict the OCBE module in Fig. 4, where MFF aggregates low- and high-level features to construct a rich embedding for normal pattern reconstruction and OCE targets to retain essential information favorable for the student to decode out the teacher's response. The convolutional layers in grey and ResBlock in green in Fig. 4 are trainable and optimized jointly with the student model $D$ during knowledge distillation on normal samples.\\n\\n3.3. Anomaly Scoring\\n\\nAt the inference stage, we first consider the measurement of pixel-level anomaly score for anomaly localization (AL). When a query sample is anomalous, the teacher model is capable of reflecting abnormality in its features. However, the student model is likely to fail in abnormal feature restoration, since the student decoder only learns to restore anomaly-free representations from the compact one-class embedding in knowledge distillation. In other words, the student $D$ generates discrepant representations from the teacher when the query is anomalous. Following Eq. (1), we obtain a set of anomaly maps from T-S representation pairs, where the value in a map $M_k$ reflects the point-wise anomaly of the $k$th feature tensors. To localize anomalies in a query image, we up-sample $M_k$ to image size. Let $\\\\Psi$ denotes the bilinear up-sampling operation used in this study. Then a precise score map $S_{AL}$ is formulated as the pixel-wise accumulation of all anomaly maps:\\n\\n$$S_{AL} = \\\\sum_{i=1}^{L} \\\\Psi(M_i).$$\\n\\nIn order to remove the noises in the score map, we smooth $S_{AL}$ by a Gaussian filter. For anomaly detection, averaging all values in a score map $S_{AL}$ is unfair for samples with small anomalous regions. The most responsive point exists for any size of anomalous regions.\"}"}
{"id": "CVPR-2022-120", "page_num": 6, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":true,\"is_diagram\":false,\"natural_text\":\"| Category/Method | Textures | Objects |\\n|----------------|----------|---------|\\n| Carpet         | 99.8     | 99.9    |\\n| Grid           | 100      | 100     |\\n| Leather        | 99.2     | 100     |\\n| Tile           | 99.5     | 100     |\\n| Wood           | 99.8     | 100     |\\n\\n**Average**\\n\\n| Textures | Objects |\\n|----------|---------|\\n| 98.8     | 95.4    |\\n| 67.2     | 76.2    |\\n| 87.7     | 92.1    |\\n| 89.5     | 89.9    |\\n| 95.5     | 96.1    |\\n\\n**Total Average**\\n\\n| Textures | Objects |\\n|----------|---------|\\n| 97.5     | 98.5    |\\n| 89.9     | 90.9    |\\n| 95.8     | 96.0    |\\n| 95.5     | 96.1    |\\n| 98.0     | 98.5    |\\n\\n**Table 1.** Anomaly Detection results on MVTec [3]. For each category with images of 256 \u00d7 256 resolution, methods achieved for the top two AUROC (%) are highlighted in bold. Our method ranks first according to the average scores of textures, objects and overall.\\n\\nAnomalous region. Hence, we define the maximum value in $S_{AL}$ as sample-level anomaly score $S_{AD}$. The intuition is that no significant response exists in their anomaly score map for normal samples.\\n\\n4. Experiments and Discussions\\n\\nEmpirical evaluations are carried on both the MVTec anomaly detection and localization benchmark and unsupervised one-class novelty detection datasets. In addition, we perform ablation study on the MVTec benchmark, investigating the effects of different modules/blocks on the final results.\\n\\n4.1. Anomaly Detection and Localization\\n\\n**Dataset.** MVTec [3] contains 15 real-world datasets for anomaly detection, with 5 classes of textures and 10 classes of objects. The training set comprises a total of 3,629 anomaly-free images. The test set has both anomalous and anomaly-free images, totaling 1,725. Each class has multiple defects for testing. In addition, pixel-level annotations are available in the test dataset for anomaly localization evaluation.\\n\\n**Experimental settings.** All images in MVTec are resized to a specific resolution (e.g. 128 \u00d7 128, 256 \u00d7 256 etc.). Following convention in prior works, anomaly detection and localization are performed on one category at a time. In this experiment, we adopt WideResNet50 as Backbone $E$ in our T-S model. We also report the AD results with ResNet18 and ResNet50 in ablation study. To train our reserve distillation model, we utilize Adam optimizer [18] with $\\\\beta = (0.9, 0.999)$. The learning rate is set to 0.005. We train 200 epochs with a batch size of 16. A Gaussian filter with $\\\\sigma = 4$ is used to smooth the anomaly score map (as described in Sec. 3.3).\\n\\nFor Anomaly detection, we take area under the receiver operating characteristic (AUROC) as the evaluation metric. We include prior arts in this experiments, including MKD [33], GT [10], GANomaly (GN) [2], Uninformed Student (US) [4], PSVDD [43], DAAD [16], MetaFormer (MF) [40], PaDiM (WResNet50) [8] and CutPaste [23].\\n\\nFor Anomaly Localization, we report both AUROC and per-region-overlap (PRO) [4]. Different from AUROC, which is used for per-pixel measurement, the PRO score treats anomaly regions with any size equally. The comparison baselines includes MKD [33], US [4], MF [40], SPADE (WResNet50) [7,29], PaDiM (WResNet50) [8], RIAD [46] and CutPaste [23].\\n\\n**Experimental results and discussions.**\\n\\nAnomaly detection results on MVTec are shown in Tab. 1. The average outcome shows that our method exceeds SOTA by 2.5%.\\n\\nFor textures and objects, our model reaches new SOTA of 99.5% and 98.0% of AUROC, respectively. The statistics of the anomaly scores are shown in Fig. 5. The non-overlap distribution of normal (blue) and anomalies (red) indicates the strong AD capability in our T-S model.\\n\\nQuantitative results on anomaly localization are summarized in Tab. 2. For both AUROC and PRO average scores over all categories, our approach surpasses state-of-the-art with 97.8% and 93.9%.\\n\\nTo investigate the robustness of our method to various anomalies, we classify the defect types into two categories: large defects or structural anomalies and tiny or inconspicuous defects, and qualitative evaluate the performance by visualization in Fig. 6 and Fig. 7.\\n\\nCompared to the runner-up (i.e. CutPaste [23]) in Tab. 1, our method produces a significant response to the whole...\"}"}
{"id": "CVPR-2022-120", "page_num": 7, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"Table 2. Anomaly Localization results with AUROC and PRO on MVTec [3]. AUROC represents a pixel-wise comparison, while PRO focuses on region-based behavior. We show the best results for AUROC and PRO in bold. Remarkable, our approach is robust and represents state-of-the-art performance under both metrics.\\n\\nFigure 5. Histogram of anomaly scores for all categories of MVTec [3] (x-axis: anomaly score from 0 to 1, and y-axis: count).\\n\\nComplexity analysis. Recent pre-trained model based approaches achieve promising performance by extracting features from anomaly-free samples as a measurement [7,8]. However, storing feature models leads to large memory consumption. In comparison, our approach achieves better performance depending only on an extra CNN model. As shown in Tab. 3. Our model obtain performance gain with low time and memory complexity.\\n\\nMethods\\n\\n| Method            | Infer. time (second on Intel i7) | Memory (MB) | Performance (AD-AUROC/AL-AUROC/AL-PRO) |\\n|-------------------|----------------------------------|-------------|-----------------------------------------|\\n| SPADE (WResNet50) | 1.40                             | 1400        | 85.5/96.5/91.7                          |\\n| PaDiM (WResNet50) | 0.95                             | 3800        | 95.5/97.5/92.1                          |\\n| Ours (WResNet50)  | 0.31                             | 352         | 98.5/97.8/93.9                          |\\n\\nTable 3. Comparison of pre-trained based approaches in terms of inference time (second on Intel i7), memory usage (MB), and performance (AD-AUROC/AL-AUROC/AL-PRO) on MVTec [3].\\n\\nLimitations. We observe that the localization performance on the transistor dataset is relatively weak, despite the good AD performance. This performance drop is caused by misinterpretation between prediction and annotation. As shown in Fig. 6, our method localize the misplaced regions, while the ground truth covers both misplaced and original areas. Alleviating this problem requires associating more features with contextual relationships. We empirically find that a higher-level feature layer with a wider perceptive field can improve the performance. For instance, anomaly detection with the second and third layer features achieves 94.5% AUROC, while using only the third layer improve the performance to 97.3%. In addition, reducing image resolution to 128 \u00d7 128 also achieves 97.6% AUROC. We present more cases of anomaly detection and localization, both positive and negative, in the supplementary material.\\n\\n4.2. One-Class Novelty Detection\\n\\nTo evaluate the generality of proposed approach, we conduct one-class novelty detection experiment on 3 sematic datasets [32], MNIST [22], FashionMNIST [41] and CIFAR10 [20]. MNIST is a hand-written digits dataset from numbers 0-9. FashionMNIST consists of images from 10 fashion product classes. Both datasets includes 60K samples for training and 10K samples for testing, all in resolution of 28 \u00d7 28. CIFAR10 is a challenging dataset for novelty detection because of its inclusion of diverse natural objects. It includes 50K training images and 10K test images with scale of 32 \u00d7 32 in 10 categories.\\n\\nFollowing the protocol mentioned in [27], we train the model with samples from a single class and detect novel samples. Note that the novelty score is defined as the sum\"}"}
{"id": "CVPR-2022-120", "page_num": 8, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"Figure 6. Anomalies from top to bottom: \\\"flip\\\" on \\\"metal nut\\\", \\\"misplaced\\\" on \\\"transistor\\\" and \\\"crack\\\" on \\\"hazelnut.\\\" Normal samples are provided as reference.\\n\\nFigure 7. Visualization on tiny or inconspicuous anomalies. From left to right: carpet, tile, wood, cable, pill, toothbrush, and screw.\\n\\n| Method         | MNIST   | F-MNIST | CIFAR10 | Caltech-256 |\\n|----------------|---------|---------|---------|--------------|\\n| LSA [1]        | 97.5    | 92.2    | 64.1    | -            |\\n| OCGAN [27]     | 97.3    | 87.8    | 65.7    | -            |\\n| HRN [17]       | 97.6    | 92.8    | 71.3    | -            |\\n| DAAD [16]      | 99.0    | -       | 75.3    | -            |\\n| MKD [33]       | 98.7    | 94.5    | 84.5    | -            |\\n| G2D [28]       | -       | -       | -       | 95.7         |\\n| Ours           | 99.3    | 95.0    | 86.5    | 99.9         |\\n\\nTable 4. AUROC(%) results for One-Class Novelty Detection. The best results are marked in bold.\\n\\nOf scores in the similarity map. The baselines in this experiment include LSA [1], OCGAN [27], HRN [17], DAAD [16] and MKD [33]. We also include the comparison with OiG [45] and G2D [28] on Caltech-256 [13].\\n\\nTab. 4 summarizes the quantitative results on the three datasets. Remarkably, our approach produces excellent results. Details of the experiments and the results of per-class comparisons are provided in the Supplementary Material.\\n\\n4.3. Ablation analysis\\n\\nWe investigate the effect of OCE and MFF blocks on AD and report the numerical results in Tab. 5. We take the pre-trained residual block [14] as baseline. Embedding from pre-trained residual block may contain anomaly features, which decreases the T-S model's representation discrepancy. Our trainable OCE block condenses feature codes and the MFM block fuses rich features into embedding, allowing for more accurate anomaly detection and localization.\\n\\n| Metric | Pre | Pre+OCE | Pre+OCE+MFM |\\n|--------|-----|---------|-------------|\\n| AUROC  | AD  |         |             |\\n| 96.0   | 97.9| 98.5    |             |\\n| AUROC  | AL  |         |             |\\n| 96.9   | 97.4| 97.8    |             |\\n| RPO    |     |         |             |\\n| 91.2   | 92.4| 93.9    |             |\\n\\nTable 5. Ablation study on pre-trained bottleneck, OCE, and MFF.\\n\\nTab. 6 displays qualitative comparisons of different backbone networks as the teacher model. Intuitively, a deeper and wider network usually has a stronger representation capacity, which facilitates detecting anomalies precisely. Noteworthy that even with a smaller neural network such as ResNet18, our reverse distillation method still achieves excellent performance.\\n\\n| Backbone | ResNet18 | ResNet50 | WResNet50 |\\n|----------|----------|----------|-----------|\\n| AUROC    | AD       | AL       | RPO       |\\n| 97.9     | 98.4     | 98.5     | 91.2      |\\n| AUROC    | AL       |          |           |\\n| 97.1     | 97.7     | 97.8     |           |\\n| RPO      |          |          |           |\\n| 91.2     | 93.1     | 93.9     |           |\\n\\nTable 6. Quantitative comparison with different backbones.\\n\\nBesides, we also explored the impact of different network layers on anomaly detection and shown the results in Tab. 7. For single-layer features, \\\\( M_2 \\\\) yields the best result as it trades off both local texture and global structure information. Multi-scale feature fusion helps to cover more types of anomalies.\\n\\n| Score Map | \\\\( M_1 \\\\) | \\\\( M_2 \\\\), \\\\( M_3 \\\\) | \\\\( M_1, M_2, M_3 \\\\) |\\n|-----------|-----------|----------------|------------------|\\n| AUROC AD  | 90.1      | 97.5           | 97.2             |\\n| AUROC AL  | 94.0      | 96.9           | 96.9             |\\n| RPO       | 88.6      | 92.6           | 89.5             |\\n\\nTable 7. Ablation study on multi-scale feature distillation.\\n\\n5. Conclusion\\n\\nWe proposed a novel knowledge distillation paradigm, reverse distillation, for anomaly detection. It holistically addressed the problem in previous KD-based AD methods and boosted the T-S model's response on anomalies. In addition, we introduced trainable one-class embedding and multi-scale feature fusion blocks in reverse distillation to improve one-class knowledge transfer. Experiments showed that our method significantly outperformed previous arts in anomaly detection, anomaly localization, and novelty detection.\"}"}

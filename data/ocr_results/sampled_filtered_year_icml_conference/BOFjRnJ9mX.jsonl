{"id": "BOFjRnJ9mX", "page_num": 13, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nA. Appendix\\nA.1. Demonstration of the influence of crystal space group on tensor properties\\n\\nDemonstration. Formally, \\\\( D = \\\\varepsilon E \\\\) can be written as\\n\\n\\\\[\\n\\\\begin{bmatrix}\\nD_x \\\\\\\\\\nD_y \\\\\\\\\\nD_z\\n\\\\end{bmatrix} =\\n\\\\begin{bmatrix}\\n\\\\varepsilon_{xx} & \\\\varepsilon_{xy} & \\\\varepsilon_{xz} \\\\\\\\\\n\\\\varepsilon_{yx} & \\\\varepsilon_{yy} & \\\\varepsilon_{yz} \\\\\\\\\\n\\\\varepsilon_{zx} & \\\\varepsilon_{zy} & \\\\varepsilon_{zz}\\n\\\\end{bmatrix}\\n\\\\begin{bmatrix}\\nE_x \\\\\\\\\\nE_y \\\\\\\\\\nE_z\\n\\\\end{bmatrix},\\n\\\\]\\n\\nwhere each \\\\( \\\\varepsilon_{ji} \\\\) element quantifies the impact of the electric field along axis \\\\( i \\\\) on the electric displacement along axis \\\\( j \\\\).\\n\\nConsider, for instance, a 90-degree rotation around the \\\\( z \\\\)-axis, denoted as \\\\( R_{1z} \\\\) as\\n\\n\\\\[\\nR_{1z} =\\n\\\\begin{bmatrix}\\n0 & -1 & 0 \\\\\\\\\\n1 & 0 & 0 \\\\\\\\\\n0 & 0 & 1\\n\\\\end{bmatrix}\\n\\\\]\\n\\nApplying this rotation to the transformation equation \\\\( \\\\varepsilon = R_i \\\\varepsilon R^{-1}_i \\\\), we obtain\\n\\n\\\\[\\n\\\\varepsilon =\\n\\\\begin{bmatrix}\\n0 & -1 & 0 \\\\\\\\\\n1 & 0 & 0 \\\\\\\\\\n0 & 0 & 1\\n\\\\end{bmatrix}\\n\\\\begin{bmatrix}\\n\\\\varepsilon_{xx} & \\\\varepsilon_{xy} & \\\\varepsilon_{xz} \\\\\\\\\\n\\\\varepsilon_{yx} & \\\\varepsilon_{yy} & \\\\varepsilon_{yz} \\\\\\\\\\n\\\\varepsilon_{zx} & \\\\varepsilon_{zy} & \\\\varepsilon_{zz}\\n\\\\end{bmatrix}\\n\\\\begin{bmatrix}\\n0 & 1 & 0 \\\\\\\\\\n-1 & 0 & 0 \\\\\\\\\\n0 & 0 & 1\\n\\\\end{bmatrix}\\n\\\\]\\n\\nSimplifying the above equation yields:\\n\\n\\\\[\\n\\\\begin{bmatrix}\\n\\\\varepsilon_{xx} & \\\\varepsilon_{xy} & \\\\varepsilon_{xz} \\\\\\\\\\n\\\\varepsilon_{yx} & \\\\varepsilon_{yy} & \\\\varepsilon_{yz} \\\\\\\\\\n\\\\varepsilon_{zx} & \\\\varepsilon_{zy} & \\\\varepsilon_{zz}\\n\\\\end{bmatrix}\\n= \\\\begin{bmatrix}\\n0 & -\\\\varepsilon_{yx} & -\\\\varepsilon_{yz} \\\\\\\\\\n-\\\\varepsilon_{xy} & \\\\varepsilon_{xx} & -\\\\varepsilon_{xz} \\\\\\\\\\n-\\\\varepsilon_{zx} & -\\\\varepsilon_{zy} & \\\\varepsilon_{zz}\\n\\\\end{bmatrix}\\n\\\\]\\n\\nIt becomes evident that a crystal possessing a 90-degree rotational symmetry along the \\\\( z \\\\)-axis has specific zero elements in its dielectric tensor, as shown below:\\n\\n\\\\[\\n\\\\varepsilon =\\n\\\\begin{bmatrix}\\n\\\\varepsilon_{xx} & \\\\varepsilon_{xy} & 0 \\\\\\\\\\n-\\\\varepsilon_{xy} & \\\\varepsilon_{xx} & 0 \\\\\\\\\\n0 & 0 & \\\\varepsilon_{zz}\\n\\\\end{bmatrix}\\n\\\\]\\n\\nA.2. GMTNet extracted crystal-level equivariant features meet the pre-established requirements\\n\\nWe provide analysis and proof in this section to demonstrate that GMTNet extracted crystal-level equivariant features meet the pre-established requirements in Sec. 3.2.\\n\\nAssumptions: crystal structure \\\\( M = (A, P, L) \\\\) satisfies given space group transformation \\\\( R \\\\in \\\\mathbb{R}^{3 \\\\times 3} \\\\), \\\\( b \\\\in \\\\mathbb{R}^3 \\\\) without any structural error, and the equivariant function \\\\( \\\\theta_{equi} \\\\) taking crystal structure \\\\( M = (A, P, L) \\\\) as input introduces no error including numerical ones.\\n\\nProof: for the transformation \\\\( R \\\\in \\\\mathbb{R}^{3 \\\\times 3} \\\\), \\\\( b \\\\in \\\\mathbb{R}^3 \\\\) in a given crystal's space group, since the crystal structure \\\\( M = (A, P, L) \\\\) satisfy this space group without structural error, we have the transformed crystal structure \\\\( M' = (A, RP + b, L) \\\\), which is an equivalent crystal structure, albeit with a reindexed arrangement. Define the reindexed arrangement as a mapping function \\\\( \\\\theta_{re} : i \\\\rightarrow i' \\\\), \\\\( 1 \\\\leq i, i' \\\\leq n \\\\). It can be seen that function \\\\( \\\\theta_{re} \\\\) is a bijection function.\\n\\nFor the crystal-level equivariant feature after the transformation \\\\( R \\\\in \\\\mathbb{R}^{3 \\\\times 3} \\\\), \\\\( b \\\\in \\\\mathbb{R}^3 \\\\), by using the equivariant function \\\\( \\\\theta_{equi} \\\\), we can have\\n\\n\\\\[\\n\\\\rho_{\\\\ell, \\\\text{rotated}} = \\\\theta_{equi}(A, RP + b, L)_{\\\\ell, \\\\text{rotated}} = WD_{\\\\ell, \\\\text{rotated}}(R) \\\\circ \\\\theta_{equi}(A, P, L)_{\\\\ell, \\\\text{rotated}} = WD_{\\\\ell, \\\\text{rotated}}(R) \\\\circ \\\\rho_{\\\\ell, \\\\text{rotated}},\\n\\\\]\\n\\nand\\n\\n\\\\[\\nG_{\\\\ell, \\\\text{rotated}} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} \\\\rho_{\\\\ell, \\\\text{rotated}} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} WD_{\\\\ell, \\\\text{rotated}}(R) \\\\circ \\\\rho_{\\\\ell, \\\\text{rotated}}.\\n\\\\]\"}"}
{"id": "BOFjRnJ9mX", "page_num": 14, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nMEGNET ETGNN GMTNet Ground Truth\\n\\ncubic\\nhexagonal\\n& trigonal\\ntetragonal\\northorhombic\\nmonoclinic\\ntriclinic\\n\\nFigure 3. Comparative visualization of dielectric tensor predictions. This figure presents a model comparison for dielectric tensor prediction, on the dielectric test set comprising various crystal systems: cubic, hexagonal, trigonal, tetragonal, orthorhombic, monoclinic, and triclinic. GMTNet's predictions are highlighted for their alignment with the spatial symmetry characteristics of the ground truth tensors, underscoring its superior performance. In contrast, models such as MEGNET and ETGNN demonstrate a notable discrepancy in capturing these symmetry aspects. The comparison underscores GMTNet's effectiveness in generating symmetry-consistent dielectric tensor predictions.\\n\\nFurther, by using the fact that $M' = (A, R P + b, L)$ is an equivalent crystal structure as $M = (A, P, L)$, albeit with a reindexed arrangement $\\\\theta_{re}: i \\\\rightarrow i', 1 \\\\leq i, i' \\\\leq n$, we can have $G^{\\\\ell} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} f^{\\\\ell i} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq \\\\theta_{re}(i) \\\\leq n} f^{\\\\ell \\\\theta_{re}(i)} = G^{\\\\ell}$ rotated, $14$. \\n\"}"}
{"id": "BOFjRnJ9mX", "page_num": 15, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nFigure 4. Visualization of elastic tensor predictions on elastic test set. The results underscore GMTNet's effectiveness in generating symmetry-consistent elastic tensor predictions with tensor order 4.\\n\\nwhich means\\n\\\\[ G_{\\\\ell} = G_{\\\\ell} \\\\text{rotated} = WD_{\\\\ell}(R) \\\\circ G_{\\\\ell}. \\\\]\\n\\nHence, the proof that GMTNet extracted crystal-level equivariant features, detailed in Sec. 3.2, meet the pre-established requirements and have the same spatial symmetry characteristics of the crystal structure is done.\\n\\nA.3. Directly converting outputs to satisfy crystal space group constraints results in sub-optimal performances.\\n\\nAs discussed in the related work section, instead of carefully designing model components to achieve the invariance of crystal space group when predicting general tensors with different orders, there is a widely used general approach, group averaging, or more generally, frame averaging, that can convert any model output to be invariant to a group of transformations of interest. However, we show in this section that directly converting outputs to satisfy crystal space groups will result in sub-optimal prediction performances.\\n\\nSpecifically, we conduct experiments using group averaging with equation\\n\\\\[ \\\\epsilon = \\\\frac{1}{n} \\\\sum_{i=1}^{n} \\\\epsilon_{R_i}, \\\\]\\n\\nto convert output of MEGNET and ETGNN to be space group invariant, and the results are shown in Tab. 11 where GA denotes using group averaging in the training and inference processes.\\n\\nTable 11. Comparison of accuracy in terms of Fnorm on the test set of dielectric tensors.\\n\\n| Method   | Fnorm |\\n|----------|-------|\\n| MEGNET   | 4.16  |\\n| ETGNN    | 3.92  |\\n| MEGNET-GA| 4.51  |\\n| ETGNN-GA | 4.07  |\\n| GMTNet   | 3.50  |\\n\\nThe results verify that directly converting outputs to satisfy crystal space groups will result in sub-optimal prediction performances, not only for methods that do not satisfy crystal tensor equivariance like MEGNET, but also for methods that satisfy crystal tensor equivariance like ETGNN.\\n\\nA.4. Experimental details and additional results\\n\\nEquivariance verification.\\n\\nThe equivariance of different models is verified on the dielectric test set using the \\\\( E(3) \\\\) invariant measurement Fnorm shown in Table 12. ETGNN and our method maintain equivariance for tensor predictions while invariant MEGNET breaks this property.\\n\\nTable 12. Equivariance analysis in terms of Fnorm \u2013 Evaluated on the most challenging triclinic system of dielectric tensors.\\n\\n|   | MEGNET | ETGNN | GMTNet |\\n|---|--------|-------|--------|\\n| Origin | 8.51  | 8.32  | 7.65   |\\n| Rotate 45-x | 9.74 | 8.32  | 7.65   |\\n| Rotate 45-y | 9.67 | 8.32  | 7.65   |\\n| Rotate 45-z | 8.51 | 8.32  | 7.65   |\\n| Equivariance | \u2717    | \u2713     | \u2713      |\"}"}
{"id": "BOFjRnJ9mX", "page_num": 16, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for $O(3)$ Equivariant Crystal Tensor Prediction\\n\\nFigure 5. Message passing details for node invariant feature updating and equivariant message passing in GMTNet. (a) Node invariant feature updating that takes node features ($f_j$, $f_i$) and edge feature ($f_{eji}$) as input to obtain the updated invariant node feature $f_{\\\\text{new}}^i$. (b) Equivariant message passing that produces high rotation order node features. In this figure, all notations follow Sec. 3.2.\\n\\nVisualization comparison. Fig. 3 presents a comparative visualization of dielectric tensor predictions across various crystal systems within the dielectric test set. In our methodology, the visualization of the dielectric tensor is generated for each direction in three-dimensional space. This is achieved by considering a directional vector $v^E = (x, y, z)$, normalized such that $|v^E|^2 = 1$. We define the electric field vector as $E = v^E$ and subsequently compute the corresponding displacement response using the formula $D = \\\\varepsilon E$. To effectively represent the displacement response in every direction within the 3D space, we introduce a surface function $\\\\theta_{\\\\text{surface}} : (v^E, \\\\varepsilon) \\\\rightarrow D$. The visualization is then rendered by utilizing the norm $|D|^2$ to determine the radial distance $r$ from the origin to the surface and the surface color.\\n\\nNotably, as shown in Fig. 3, GMTNet's predictions exhibit a high degree of alignment with the spatial symmetry characteristics inherent in the ground truth tensors, thereby highlighting its superior predictive capabilities. In contrast, baseline models such as MEGNET and ETGNN show large deviations in capturing these symmetry aspects. This comparative analysis shows GMTNet's effectiveness in producing dielectric tensor predictions that are consistent with the underlying symmetries of the crystal structures.\\n\\nWe further provide visualization comparison between ground truth piezoelectric and elastic tensors with GMTNet predicted ones on the piezoelectric and elastic test sets in Fig. 2 and Fig. 4 using MTEX (Bachmann et al., 2010). These comparisons further demonstrate GMTNet's effectiveness in generating symmetry-consistent higher order tensor predictions with tensor order 3 (piezoelectric tensors) and 4 (elastic tensors).\\n\\nConfigurations of GMTNet. The detailed architecture of node invariant feature updating and equivariant message passing within GMTNet is shown in Fig. 5. For the edge embedding, we use $c = 0.75$ and RBF kernels with value from $-4$ to $0$ which maps $-c/|\\\\nu_{ji}|^2$ to a 512 dimensional vector. This 512 dimensional vector is mapped to 128 dimensional vector by a nonlinear layer to $f_{eji}$. We use 2 layers of node invariant feature updating and 3 layers of equivariant message passing for all tasks including dielectric, piezoelectric, and elastic tensors. Learning rate of 0.001, epoch number of 200, and batch size of 64 are used for dielectric, piezoelectric, and elastic tensors. We construct crystal graphs using radius determined by the 16-th nearest neighbor. The source code of GMTNet will be released when the paper is publicly available.\\n\\nImplementations of MEGNET. Following the original paper (Chen et al., 2019), we use three layers of MEGNET message passing with the same feature dimensions as mentioned in the paper. We train MEGNET for 200 epochs using Huber loss with a learning rate of 0.001 and AdamW optimizer with $10^{-5}$ weight decay. The same polynomial learning rate decay scheduler as our GMTNet implementation is used. To predict a tensor matrix of shape $3 \\\\times 3$, we change the original output dimension from one to nine.\\n\\nImplementations of ETGNN. Following ETGNN (Zhong et al., 2023), we use four DimeNet++ layers with hidden dimension 128 and ELU activation function to serve as the invariant message-passing network. Since the code of ETGNN is not publicly accessible, we implement DimeNet++ layers following the code provided by Du et al. (2023). We train ETGNN for 200 epochs using Huber loss with a learning rate of 0.001 and AdamW optimizer with $10^{-5}$ weight decay. The same polynomial learning rate decay scheduler as our GMTNet implementation is used.\\n\\nTolerance-guided prediction adjustment. As discussed in Sec. 5.2, the Wigner D matrix computation provided in the e3nn package (Geiger & Smidt, 2022), introduces numerical errors, notably more pronounced in features with higher rotation orders. To mitigate the impact of this issue, we implement a tolerance-guided prediction adjustment during inference.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 9, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for $O(3)$ Equivariant Crystal Tensor Prediction\\ndeling a diverse range of tensor properties. The results, as\\ndetailed in Table 5, are indicative of GMTNet\u2019s robust per-\\nformance. It consistently achieves a 100% success rate in ac-\\ncurately identifying zero elements and mutually dependent\\nelements. Furthermore, GMTNet demonstrates impressive\\nproficiency for these more complex tensors, achieving high-\\nquality prediction rates of 49.1% for piezoelectric tensors\\nand 66.1% for elastic tensors, underscoring its effectiveness\\nand general applicability in the domain of tensor property\\nprediction within materials science.\\n\\nTable 6. Efficiency analysis on the dielectric dataset.\\n\\n| Model     | Time/Batch (s) | Num. Param. | Fnorm |\\n|-----------|----------------|-------------|-------|\\n| ETGNN     | 0.121          | 1.1 M       | 3.92  |\\n| GMTNet    | 0.069          | 0.7 M       | 3.50  |\\n\\nEfficiency comparison. The results presented in Table 6\\nhighlight the efficiency gains achieved by our method when\\ncompared to ETGNN. Our approach not only reduces the\\nrunning time by 43% but also utilizes 37% fewer trainable\\nparameters, remarkably accompanied by a significant en-\\nhancement in accuracy. These outcomes demonstrate the\\nrobustness and superior modeling capability of GMTNet,\\nestablishing it as a more efficient and effective solution in\\nthe realm of ML-based crystal tensor prediction.\\n\\nTable 7. Ablation studies on the dielectric dataset.\\n\\n| Component               | Fnorm |\\n|-------------------------|-------|\\n| Equivariance            | 4.15  |\\n| Structure Correction    | 3.76  |\\n| Symmetry Constraints    | 3.72  |\\n| Equality                | 3.56  |\\n\\nAblation study. Here, we evaluate the importance of each\\ncomponent in GMTNet. To begin with, the equivariant\\ntensor prediction module enables the $O(3)$ equivariant pre-\\ndiction of tensor properties. As shown in Table 7, it plays a\\nvital role and decreases Fnorm from 4.15 to 3.76, which is\\nalready better than ETGNN. Without this module, GMTNet\\ncannot provide equivariant predictions.\\n\\nFurthermore, the symmetry enforcement module, including\\nstructure correction and symmetry constraint crystal-level\\nfeature correction enhances GMTNet\u2019s robustness beyond\\nideal crystal inputs and message-passing operations for re-\\nalistic crystal inputs and message passing with numerical\\nerrors. It can be seen in Table 7 that the symmetry enforce-\\nment module further decreases Fnorm from 3.76 to 3.56, and\\ntolerance-guided prediction adjustment (equality) described\\nin Sec. 5.2 decreases Fnorm to 3.50.\\n\\nWe also demonstrate that GMTNet without the symme-\\ntry enforcement module already satisfies $O(3)$ equivari-\\nance and space group invariance when predicting crys-\\ntal tensors for ideal crystal structures, as shown in Ta-\\nble 8 and Table 9. Specifically, we include the zero and\\nequal entry tests on ideal crystal inputs without distor-\\ntions as shown below.\\n\\nTable 8. Predicting symmetry-constrained zero-valued dielectric\\ntensor elements for ideal crystal structures.\\n\\n| Crystal System | ETGNN | GMTNet w/o correction |\\n|----------------|-------|-----------------------|\\n| Cubic          | 5.2\u00d710^{-8} | 0.0                  |\\n| Tetragonal     | 5.6\u00d710^{-8} | 1.3\u00d710^{-16}        |\\n| Hexa-Trigonal  | 4.3\u00d710^{-3}  | 3.5\u00d710^{-9}          |\\n| Orthorhombic   | 2.5\u00d710^{-8}  | 0.0                  |\\n| Monoclinic     | 3.5\u00d710^{-8}  | 0.0                  |\\n\\nTable 9. Predicting symmetry-constrained equal-valued dielectric\\ntensor elements for ideal crystal structures.\\n\\n| Crystal System | ETGNN | GMTNet w/o correction |\\n|----------------|-------|-----------------------|\\n| Cubic          | \u2713     | \u2713                     |\\n| Tetragonal     | \u2713     | \u2713                     |\\n| Hexa-Trigonal  | \u2757    | \u2713                     |\\n| Orthorhombic   | \u2713     | \u2713                     |\\n| Monoclinic     | \u2713     | \u2713                     |\\n\\nAdditionally, it is worth noting that GMTNet without the\\nsymmetry enforcement module is not robust enough for\\nrealistic crystal inputs with structural errors, or in other\\nwords, minor distortions that disrupt the crystal symmetry,\\nas shown in Table. 10.\\n\\nTable 10. Predicting symmetry-constrained zero-valued dielectric\\ntensor elements. Success rate measured by error < 10^{-5}.\\n\\n| Crystal System | ETGNN | GMTNet w/o correction | GMTNet |\\n|----------------|-------|-----------------------|--------|\\n| Cubic          | 13.5% | 44.6%                 | 100%   |\\n| Tetragonal     | 1.3%  | 56.6%                 | 100%   |\\n| Hexa-Trigonal  | 2.3%  | 57.0%                 | 100%   |\\n| Orthorhombic   | 0%    | 68.7%                 | 100%   |\\n| Monoclinic     | 6.4%  | 78.2%                 | 100%   |\\n\\n6. Conclusion and Limitations\\n\\nTo conclude, we present GMTNet, a symmetry informed\\nequivariant network for crystal tensor property prediction.\\nIt is carefully designed to satisfy the unique equivariance to\\n$O(3)$ group and invariance to crystal space groups, across\\nvarious tensor properties. A crystal tensor dataset is cu-\\nrated with specifically designed evaluation metrics to foster\\nthe advancements in ML-based tensor property prediction.\\nExperimental results demonstrate that GMTNet achieves\\npromising performance on crystal tensors of various orders,\\nand generates predictions fully consistent with the intrinsic\\ncrystal symmetries. The limitations of our current GMTNet\\ninclude (1) the scale of our curated tensor dataset can be ex-\\npanded, which could potentially enhance the model\u2019s robust-\\nness and the diversity of its applications, and (2) GMTNet\\ncurrently cannot generate tensor predictions for amorphous\\nmaterials. These directions can be explored as future works.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 10, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for $O(3)$ Equivariant Crystal Tensor Prediction\\n\\nAcknowledgments\\nWe thank Tian Xie, Chenru Duan, Yuanqi Du, Haiyang Yu, and Youzhi Luo for insightful discussions. X.F.Q. acknowledges partial support from National Science Foundation under awards CMMI-2226908 and DMR-2103842. X.N.Q. acknowledges partial support from National Science Foundation under awards DMR-2119103 and IIS-2212419. S.J. acknowledges partial support from National Science Foundation under awards IIS-2243850 and CNS-2328395.\\n\\nImpact Statement\\nThis work can be used to discover novel materials with desirable tensor properties. Hence, if misused, the societal consequences of discovering materials with specific tensor properties may apply to this work.\\n\\nReferences\\nBachmann, F., Hielscher, R., and Schaeben, H. Texture analysis with mtex\u2013free and open source software toolbox. Solid State Phenomena, 160:63\u201368, 2010.\\n\\nBatatia, I., Kovacs, D. P., Simm, G., Ortner, C., and Cs\u00e1nyi, G. MACE: Higher Order Equivariant Message Passing Neural Networks for Fast and Accurate Force Fields. Advances in Neural Information Processing Systems, 35:11423\u201311436, 2022.\\n\\nBatzner, S., Musaelian, A., Sun, L., Geiger, M., Mailoa, J. P., Kornbluth, M., Molinari, N., Smidt, T. E., and Kozinsky, B. E(3)-equivariant graph neural networks for data-efficient and accurate interatomic potentials. Nature Communications, 13:2453, 2022.\\n\\nChen, C. and Ong, S. P. A universal graph deep learning interatomic potential for the periodic table. Nature Computational Science, 2(11):718\u2013728, 2022.\\n\\nChen, C., Ye, W., Zuo, Y., Zheng, C., and Ong, S. P. Graph Networks as a Universal Machine Learning Framework for Molecules and Crystals. Chemistry of Materials, 31(9):3564\u20133572, 2019.\\n\\nChoudhary, K. and DeCost, B. Atomistic Line Graph Neural Network for improved materials property predictions. npj Computational Materials, 7:185, 2021.\\n\\nChoudhary, K., Garrity, K. F., Reid, A. C., DeCost, B., Biacchi, A. J., Hight Walker, A. R., Trautt, Z., Hattrick-Simpers, J., Kusne, A. G., Centrone, A., et al. The joint automated repository for various integrated simulations (JARVIS) for data-driven materials design. npj Computational Materials, 6:173, 2020.\\n\\nDeng, B., Zhong, P., Jun, K., Riebesell, J., Han, K., Bartel, C. J., and Ceder, G. Chgnet as a pretrained universal neural network potential for charge-informed atomistic modelling. Nature Machine Intelligence, 5(9):1031\u20131041, 2023.\\n\\nDu, Y., Wang, Y., Huang, Y., Li, J. C., Zhu, Y., Xie, T., Duan, C., Gregoire, J., and Gomes, C. P. M\u00b2 Hub: Unlocking the potential of machine learning for materials discovery. In The 37th Annual Conference on Neural Information Processing Systems Datasets and Benchmarks Track, 2023.\\n\\nDunn, A., Wang, Q., Ganose, A., Dopp, D., and Jain, A. Benchmarking materials property prediction methods: the Matbench test set and Automatminer reference algorithm. npj Computational Materials, 6:138, 2020.\\n\\nFu, C., Yan, K., Wang, L., Au, W. Y., McThrow, M., Komikado, T., Maruhashi, K., Uchino, K., Qian, X., and Ji, S. A latent diffusion model for protein structure generation. arXiv preprint arXiv:2305.04120, 2023.\\n\\nGeiger, M. and Smidt, T. e3nn: Euclidean Neural Networks. arXiv preprint arXiv:2207.09453, 2022.\\n\\nGong, S., Yan, K., Xie, T., Shao-Horn, Y., Gomez-Bombarelli, R., Ji, S., and Grossman, J. Examining graph neural networks for crystal structures: limitations and opportunities for capturing periodicity. Science Advances, 9(45), 2023.\\n\\nGriffiths, D. J. and Schroeter, D. F. Introduction to Quantum Mechanics. Cambridge University Press, 2018.\\n\\nHuber, P. J. Robust Estimation of a Location Parameter. In Breakthroughs in Statistics: Methodology and Distribution, pp. 492\u2013518. Springer, 1992.\\n\\nHunter, J. D. Matplotlib: A 2D graphics environment. Computing in Science & Engineering, 9(3):90\u201395, 2007. doi:10.1109/MCSE.2007.55.\\n\\nJing, B., Eismann, S., Suriana, P., Townshend, R. J. L., and Dror, R. Learning from protein structure with geometric vector perceptrons. In International Conference on Learning Representations, 2020.\\n\\nLiao, Y.-L. and Smidt, T. Equiformer: Equivariant graph attention transformer for 3D atomistic graphs. arXiv preprint arXiv:2206.11990, 2022.\\n\\nLin, Y., Yan, K., Luo, Y., Liu, Y., Qian, X., and Ji, S. Efficient approximations of complete interatomic potentials for crystal property prediction. In ICML, pp. 21260\u201321287, 2023.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 11, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":null}"}
{"id": "BOFjRnJ9mX", "page_num": 12, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nH., Stark, H., Gui, S., Edwards, C., Gao, N., Ladera, A., Wu, T., Hofgard, E. F., Tehrani, A. M., Wang, R., Daigavane, A., Bohde, M., Kurtin, J., Huang, Q., Phung, T., Xu, M., Joshi, C. K., Mathis, S. V., Azizzadenesheli, K., Fang, A., Aspuru-Guzik, A., Bekkers, E., Bronstein, M., Zitnik, M., Anandkumar, A., Ermon, S., Li\u00f2, P., G\u00fcnemann, S., Leskovec, J., Ji, H., Sun, J., Barzilay, R., Jaakkola, T., Coley, C. W., Qian, X., Qian, X., Smidt, T., and Ji, S. Artificial intelligence for science in quantum, atomistic, and continuum systems. arXiv preprint arXiv:2307.08423, 2023.\\n\\nZhong, Y., Yu, H., Gong, X., and Xiang, H. A general tensor prediction framework based on graph neural networks. The Journal of Physical Chemistry Letters, 14(28):6339\u20136348, 2023.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 5, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nare applied to the directional edge feature \\\\( \\\\hat{\\\\nu}_{ji} \\\\) and integrated with the invariant edge feature \\\\( f_{e_{ji}} \\\\) to form messages from node \\\\( j \\\\) to node \\\\( i \\\\) represented as \\\\( F \\\\),\\n\\n\\\\[\\nF(\\\\ell_{\\\\text{in}}, \\\\ell_{f_{ji}})_{c,m}(f_{e_{ji}}, \\\\hat{\\\\nu}_{ji}) = \\\\xi(\\\\ell_{\\\\text{in}}, \\\\ell_{f_{ji}})_{c}(f_{e_{ji}})\\\\ Y_{\\\\ell_{f_{m}}}(\\\\hat{\\\\nu}_{ji}), \\\\quad (4)\\n\\\\]\\n\\nwhere \\\\( \\\\xi_{c} \\\\) represents a nonlinear layer corresponding to channel index \\\\( c \\\\). The convolutional module then aggregates neighboring messages to the center node \\\\( i \\\\) through tensor product as,\\n\\n\\\\[\\nf_{\\\\ell_{\\\\text{out}}}^{i,c} = \\\\sum_{j \\\\in N(i)} (F(\\\\ell_{\\\\text{in}}, c, \\\\ell_{f_{ji}})(f_{e_{ji}}, \\\\hat{\\\\nu}_{ji}) \\\\otimes f_{\\\\ell_{\\\\text{in}}}^{i})_{\\\\ell_{\\\\text{out}}}, \\\\quad (5)\\n\\\\]\\n\\nadhering to the constraint \\\\( |\\\\ell_{\\\\text{in}} - \\\\ell_{f_{ji}}| \\\\leq \\\\ell_{\\\\text{out}} \\\\leq \\\\ell_{\\\\text{in}} + \\\\ell_{f_{ji}} \\\\).\\n\\nThe stacking of multiple layers of this mechanism allows for the extraction of high rotation order features at the atomic level.\\n\\nEquivariant crystal-level feature extraction. After obtaining high rotation order equivariant node features, the crystal-level equivariant features are aggregated as follows,\\n\\n\\\\[\\nG_{\\\\ell_{\\\\text{out}}} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} f_{\\\\ell_{i}}. \\\\quad (6)\\n\\\\]\\n\\nA detailed analysis confirming that these crystal-level equivariant features meet the pre-established requirements is presented in Appendix A.3.\\n\\n3.3. Equivariant Tensor Property Prediction\\n\\nConstructing tensor predictions such as dielectric, piezoelectric, and elastic tensors in matrix forms that satisfy all crystal symmetry constraints and O(3) equivariance is non-trivial. Rather than directly employing crystal-level equivariant features to construct matrices, our approach simulates the physical responses that these properties represent.\\n\\nLet's take dielectric tensor \\\\( \\\\epsilon \\\\) as an example. It characterizes the electric displacement field response \\\\( D \\\\in \\\\mathbb{R}^{3} \\\\) of a crystal under an external electric field \\\\( E \\\\in \\\\mathbb{R}^{3} \\\\), with \\\\( D = \\\\epsilon E \\\\). We predict an O(3) equivariant electric displacement \\\\( D \\\\) by treating \\\\( E \\\\) as a conditional input and utilizing tensor products. This approach effectively simulates the interaction between the electrical field \\\\( E \\\\) and the crystal. The implementation employs a tensor product layer as\\n\\n\\\\[\\nD = \\\\sum_{\\\\ell_{\\\\text{in}}} G_{\\\\ell_{\\\\text{in}}} (G_{\\\\ell_{\\\\text{in}}} \\\\otimes E_{\\\\ell_{\\\\text{in}}}) \\\\epsilon_{\\\\ell_{\\\\text{in}}}, \\\\quad (7)\\n\\\\]\\n\\nwhere \\\\( E \\\\) and \\\\( D \\\\) are vectors of rotation order \\\\( \\\\ell_{\\\\text{in}} = 1 \\\\). The dielectric tensor is subsequently derived by calculating the gradient \\\\( \\\\epsilon = \\\\frac{\\\\partial D}{\\\\partial E} \\\\).\\n\\nThis approach ensures that the predicted dielectric tensor inherently adheres to the required equivariance properties. The versatility of this module extends to other crystal tensor properties, each conforming to their unique equivariance criteria. The corresponding modules for piezoelectric and elastic tensors are developed as follows:\\n\\n- Piezoelectric tensor: strain \\\\( \\\\epsilon \\\\) is a \\\\( 3 \\\\times 3 \\\\) tensor that consists of irreducible representations with rotation order 0, 1, and 2. The corresponding tensor product is\\n\\n\\\\[\\nD_{\\\\ell_{\\\\text{in}}} = P_{\\\\ell_{\\\\text{in}}} G_{\\\\ell_{\\\\text{in}}} (G_{\\\\ell_{\\\\text{in}}} \\\\otimes \\\\epsilon_{\\\\ell_{\\\\text{in}}}) \\\\epsilon_{\\\\ell_{\\\\text{in}}}, \\\\quad (8)\\n\\\\]\\n\\n- Elastic tensor: strain \\\\( \\\\epsilon \\\\) and stress \\\\( \\\\sigma \\\\) are \\\\( 3 \\\\times 3 \\\\) tensor that consist of irreducible representations with rotation order 0, 1, and 2. The corresponding tensor product is\\n\\n\\\\[\\n\\\\sigma_{\\\\ell_{\\\\text{in}}} = P_{\\\\ell_{\\\\text{in}}} G_{\\\\ell_{\\\\text{in}}} (G_{\\\\ell_{\\\\text{in}}} \\\\otimes \\\\epsilon_{\\\\ell_{\\\\text{in}}}) \\\\epsilon_{\\\\ell_{\\\\text{in}}}, \\\\quad (9)\\n\\\\]\\n\\n3.4. Crystal Symmetry Enforcement Module\\n\\nIt is worth noting that GMTNet already satisfies both O(3) tensor equivariance and space group constraints using components demonstrated in Sec. 3.1, Sec. 3.2, and Sec. 3.3, including symmetry-informed crystal graph construction, crystal-level equivariant feature extraction, and equivariant tensor property prediction. Additionally, we aim to build a robust system that satisfies O(3) tensor equivariance and space group constraints not only for ideal crystal inputs and message passing without numerical errors but also for realistic crystal inputs and message passing operations with small errors.\\n\\nChallenges in crystal symmetry. In the materials science field, the determination of crystal symmetry in crystalline structures is often subject to a distortion tolerance. For large-scale crystal datasets, such as the Materials Project (MP) and JARVIS, a typical Euclidean distance tolerance is set at \\\\( 0.01 \\\\). This means that if the largest pairwise distortion, measured before and after a symmetry transformation, falls below this threshold, the transformation is considered part of the crystal's symmetry group. Hence, minor distortions in the input crystal structures can disrupt the crystal symmetry. Additionally, numerical errors during message passing will also slightly alter the pairwise relationships between atoms, as outlined in the atom-level feature requirements in Sec. 3.2. These distortions and numerical inaccuracies present challenges in generating predictions that fully comply with crystal symmetry constraints.\\n\\nCrystal symmetry enforcement module. To address the challenge of upholding crystal symmetry in tensor predictions, we introduce a crystal symmetry enforcement module. This module simplifies the complex symmetry constraints of tensor properties into constraints applicable to crystal-level features. For any transformation \\\\( R \\\\in \\\\mathbb{R}^{3 \\\\times 3}, b \\\\in \\\\mathbb{R}^{3} \\\\) within the crystal's symmetry group, applying \\\\( M' = (A, R P + b, L) \\\\) leaves the crystal structure unchanged. However, the node features for each node \\\\( i \\\\) will be modified as follows:\\n\\n\\\\[\\nf_{\\\\ell_{i}}' = W D_{\\\\ell_{i}}(R) \\\\circ f_{\\\\ell_{i}}, \\\\quad (8)\\n\\\\]\"}"}
{"id": "BOFjRnJ9mX", "page_num": 6, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nwhere \\\\( \\\\circ \\\\) denotes matrix multiplication and \\\\( W_D^{\\\\ell}(R) \\\\) denotes the Wigner D-transformation matrix for the irreducible representation with rotation order \\\\( \\\\ell \\\\) and 3D rotation \\\\( R \\\\). The crystal-level representation then becomes\\n\\n\\\\[\\nG_{\\\\ell}' = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} W_D^{\\\\ell}(R_i) \\\\circ f_{\\\\ell i} = W_D^{\\\\ell}(R) \\\\circ G_{\\\\ell}.\\n\\\\]\\n\\nFor a crystal structure belonging to a specific crystal space group with transformations \\\\( \\\\{ R_1, R_2, \\\\cdots, R_s \\\\} \\\\), due to the fact that macroscopic tensor properties of crystals will not change under translations, we focus on the rotation and reflection transformations and remove duplicates to form \\\\( \\\\{ R_1, R_2, \\\\cdots, R_n \\\\} \\\\). We verify that this set still constitutes a group and adheres to the four group conditions. To impose symmetry constraints on tensor predictions, we ensure that:\\n\\n\\\\[\\nG_{\\\\ell} = W_D^{\\\\ell}(R) \\\\circ G_{\\\\ell},\\n\\\\]\\n\\nfor every \\\\( R \\\\) in \\\\( \\\\{ R_1, R_2, \\\\cdots, R_n \\\\} \\\\) by setting\\n\\n\\\\[\\nG_{\\\\ell \\\\text{sym}} = \\\\frac{1}{n} \\\\sum_{1 \\\\leq i \\\\leq n} W_D^{\\\\ell}(R_i) \\\\circ G_{\\\\ell},\\n\\\\]\\n\\nand group theory guarantees that:\\n\\n\\\\[\\nW_D^{\\\\ell}(R) \\\\circ G_{\\\\ell \\\\text{sym}} = G_{\\\\ell \\\\text{sym}}.\\n\\\\]\\n\\nAdditionally, we can reduce small distortions in the input crystal structures by refining the crystal input structures using their space group transformations.\\n\\n3.5. Equivariance and Symmetry Verification\\n\\nEquivariance of tensor properties. Applying \\\\( R \\\\in \\\\mathbb{R}^{3 \\\\times 3} \\\\), \\\\( |R| = \\\\pm 1 \\\\) to the crystal structure and the external electrical field will result in\\n\\n\\\\[\\nG_{\\\\ell}' = W_D^{\\\\ell}(R) \\\\circ G_{\\\\ell},\\n\\\\]\\n\\nand\\n\\n\\\\[\\nR_D = \\\\sum_{\\\\ell=1}^D G_{\\\\ell} \\\\circ (W_D^{\\\\ell}(R) \\\\circ G_{\\\\ell} \\\\otimes RE_{\\\\ell}=1) \\\\ell D=1 = G_{\\\\ell} \\\\circ (W_D^{\\\\ell}(R) \\\\circ G_{\\\\ell} \\\\otimes RE_{\\\\ell}=1) \\\\ell D=1.\\n\\\\]\\n\\nThe corresponding \\\\( \\\\varepsilon' \\\\) will be\\n\\n\\\\[\\n\\\\varepsilon' = \\\\frac{\\\\partial}{\\\\partial R} (R_D) \\\\frac{\\\\partial}{\\\\partial R} (RE) = \\\\frac{\\\\partial}{\\\\partial R} (D) \\\\frac{\\\\partial}{\\\\partial R} (E) - 1 = R \\\\varepsilon R^T,\\n\\\\]\\n\\nwhich satisfies the tensor's equivariance, and similar properties can be proven for piezoelectric and elastic tensors.\\n\\nCrystal symmetry of tensor properties. Let's consider a pair of external perturbation and crystal response \\\\( (E, D) \\\\). When the crystal structure is rotated by \\\\( R_i \\\\) (one of the crystal's space group symmetry operations), while \\\\( E \\\\) remains constant, the resultant displacement field \\\\( D' \\\\) is given by\\n\\n\\\\[\\nD' = \\\\sum_{\\\\ell=1}^D G_{\\\\ell} \\\\circ (W_D^{\\\\ell}(R_i) \\\\circ G_{\\\\ell} \\\\otimes E_{\\\\ell}=1) \\\\ell D=1 = D,\\n\\\\]\\n\\ndue to \\\\( W_D^{\\\\ell}(R_i) \\\\circ G_{\\\\ell} = G_{\\\\ell} \\\\), with the dielectric tensor \\\\( \\\\varepsilon' \\\\) being\\n\\n\\\\[\\n\\\\varepsilon' = \\\\frac{\\\\partial}{\\\\partial E} (D) \\\\frac{\\\\partial}{\\\\partial E} (E) = \\\\varepsilon,\\n\\\\]\\n\\nafter the transformation \\\\( R_i \\\\). Similar proofs apply to the piezo and elastic tensors, underscoring the consistency of these tensor properties with crystal symmetry principles.\\n\\n4. Related Works\\n\\nEquivariant graph neural networks. Equivariant graph neural networks have demonstrated remarkable capabilities in modeling atomic systems (Sch\u00fctt et al., 2017; Zhang et al., 2023) including molecules (Satorras et al., 2021; Sch\u00fctt et al., 2021; Liao & Smidt, 2022; Batzner et al., 2022; Batautia et al., 2022), materials (Xie et al., 2022; Luo et al., 2023; Yan et al., 2024), and proteins (Jing et al., 2020; Fu et al., 2023). These networks have been particularly developed to predict either invariant scalar properties such as formation energy and band gap, or equivariant 3D vector properties including atomic forces and positional shifts. Despite these advancements, the specific challenge of predicting high-order tensor properties such as dielectric, piezoelectric, and elastic tensors while maintaining their inherent equivariance properties remains unexplored. Furthermore, the task of ensuring that tensor predictions conform to the stringent crystal symmetry constraints presents a unique and complex challenge that has not been addressed in previous works.\\n\\nMachine learning based crystal property prediction. The realm of crystal property prediction has witnessed a substantial leap forward with the advent of machine learning techniques. These methods (Xie & Grossman, 2018; Chen et al., 2019; Louis et al., 2020; Choudhary & DeCost, 2021; Yan et al., 2022; Deng et al., 2023; Ruff et al., 2023) offer a significant acceleration that are often several orders of magnitude faster than traditional Density Functional Theory (DFT) calculations while maintaining a commendable level of prediction accuracy. However, the primary focus of most existing studies has been on predicting scalar properties. Extending beyond scalar property prediction, Chen & Ong (2022) introduced a method enabling invariant networks to predict atomic forces and stress by deriving gradients relative to energy predictions. Yet, it falls short to predict a broader range of tensor properties inherent in crystals. Recent work by Zhong et al. (2023) has furthered this progress, enabling invariant graph neural networks to produce tensor-form predictions through the outer product of edge vectors. This technique generates a \\\\( 3 \\\\times 3 \\\\) matrix from \\\\( \\\\nu_{ji} \\\\nu_{ji}^T \\\\) and a \\\\( 3 \\\\times 3 \\\\times 3 \\\\) matrix from \\\\( \\\\nu_{ji} \\\\cdot \\\\nu_{ji} \\\\cdot \\\\nu_{ji} \\\\), where \\\\( \\\\cdot \\\\) denotes the outer product. Despite its innovation, this approach introduces a significant computational complexity of \\\\( O(nk^2m-1) \\\\) for tensors of order-\\\\( m \\\\) with \\\\( k \\\\) denoting the average number of edges per atom, and requires specialized...\"}"}
{"id": "BOFjRnJ9mX", "page_num": 7, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\ndesigns for different tensors to account for anti-symmetry (e.g., $\\\\nu_{ji}^T \\\\nu_{ji}$ does not include anti-symmetry). Most notably, it fails to enforce crystal symmetry constraints in tensor predictions as shown in the experimental results. In contrast, our method significantly diverges from Zhong et al. (2023). We achieve a consistent computational complexity of $O(nk)$, with only two-hop message passing for tensors of varying orders, and inherently resolves the issue of anti-symmetry often encountered in outer product operations like $\\\\nu_{ji}^T \\\\nu_{ji}$. Critically, our method integrates crystal symmetry constraints that are the direct consequence of symmetry and critical to be obeyed when developing ML-based tensor property predictions. This has been demonstrated in our experimental results. Our innovative technique represents a notable stride forward in the field of machine learning-based prediction of crystal tensor properties, effectively overcoming the limitations of previous methods and enhancing the scope and accuracy of predictive modeling in the domain of materials science.\\n\\nAdditionally, instead of carefully designing model components to achieve the invariance of crystal space groups when predicting general tensors with different orders, there is a widely used general approach, group averaging (Murphy et al., 2018; Yarotsky, 2022), or more generally, frame averaging (Puny et al., 2021), that can convert any model output to be invariant to a group of transformations of interest. However, we show in Appendix A.3 that directly converting outputs to satisfy crystal space groups will result in sub-optimal prediction performances.\\n\\n5. Experiments\\n\\n5.1. Curated Crystal Tensor Property Dataset\\n\\nIn our research, a dataset is curated specifically focusing on crystal tensor properties, including dielectric, piezoelectric, and elastic tensors, sourced from the JARVIS-DFT database (Choudhary et al., 2020). This dataset has been constructed with a keen emphasis on ensuring congruence between the properties and structures, achieved by extracting both the tensor property values and corresponding crystal structures directly from the DFT calculation files. This approach guarantees that the symmetry of the properties aligns with that of the structures. Notably, each tensor property within this dataset is computed using a consistent DFT core, ensuring uniformity in the calculation method.\\n\\nTable 1. Dataset statistics. Fnorm denotes Frobenius norm.\\n\\n| Dataset  | # Samples | Fnorm Mean | Fnorm STD | # Elem. |\\n|----------|-----------|------------|-----------|---------|\\n| Dielectric | 4713      | 14.7       | 18.2      | 87      |\\n| Piezoelectric | 4998     | 0.143      | 3.09      | 87      |\\n| Elastic   | 14220     | 327        | 249       | 87      |\\n\\nThe dataset's statistics, as detailed in Table 1, underscores the significant challenges posed in predicting crystal tensor properties. These challenges stem from several factors: (1) the diversity of constituting elements in each dataset, with more than 80 different elements included, (2) the limited number of available training samples, which is less than 5,000 for dielectric and piezoelectric tensors and less than 15,000 for elastic tensors, and (3) the substantial variability observed in the properties, as indicated by the Frobenius norm (denoted as Fnorm in the table). The dielectric tensor is relative dielectric constant with respect to vacuum permittivity $\\\\varepsilon_0$ and unitless ($\\\\varepsilon_0 = 8.854 \\\\times 10^{-12} \\\\text{CV}^{-1} \\\\text{m}^{-1}$).\\n\\n5.2. Experimental Setup\\n\\nBaseline methods. We benchmark against two key methods in the field. The first is the invariant MEGNET model (Chen et al., 2019), which has been previously employed for predicting dielectric tensors (Morita et al., 2020). The second is ETGNN (Zhong et al., 2023), known for its capacity to generate tensor-form predictions.\\n\\nEvaluation metrics for tensor predictions. Given the limited number of studies capable of producing crystal tensor properties of various orders, there is a need for well-defined evaluation metrics to foster advancements in ML-based tensor property prediction. To thoroughly assess the quality of tensor predictions, we propose the following metrics, each targeting a specific aspect of the tensor prediction quality. (1) Success rate in capturing zero elements that evaluates the ability of the model to correctly identify tensor elements that should be zero-valued due to symmetry constraints inherent in crystal structures. (2) Success rate in identifying mutually dependent elements that measures the model's accuracy in capturing the equality between tensor elements that are dependent due to symmetry. (3) Frobenius norm (Fnorm) distance that is an $E^3$ invariant measure for crystal tensor properties, averaged across different crystal systems. It is worth noting that the widely used MAE distance is not $E^3$ invariant for tensor properties. (4) High-quality prediction rate (EwT) that is determined by the ratio of Fnorm(error) to Fnorm(label) being less than 25%. This threshold is aligned with DFPT (Petousis et al., 2016) standards for comparing against experimental results, offering a robust benchmark for prediction accuracy.\\n\\nExperimental settings. A single NVIDIA A100 GPU is used for computing. We directly follow Chen et al. (2019) and Zhong et al. (2023) to implement MEGNET and ETGNN, with more details shown in Appendix A.4. For each property, we split the samples into training, evaluation, and test sets using ratio 8:1:1. To train our model, we use Huber loss (Huber, 1992) with AdamW (Loshchilov & Hutter, 2018), $10^{-5}$ weight decay, and polynomial decay for the learning rate. It is worth noting that the Wigner D matrix calculation provided in e3nn (Geiger & Smidt, 2022) intro\"}"}
{"id": "BOFjRnJ9mX", "page_num": 8, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nGround Truth\\nGMTNet\\n\\nFigure 2. Visualization of piezoelectric tensor predictions on piezoelectric test set. The results underscore GMTNet's effectiveness in generating symmetry-consistent piezoelectric tensor predictions with tensor order 3.\\n\\nduces numerical errors, and the error is larger for higher rotation order features. To address this issue, we provide a detailed approach with the tolerance that can further adjust the tensor predictions in Appendix A.4. We use maximum rotation order $\\\\ell_{\\\\text{max}} = 3$ features for dielectric and piezoelectric tensors, while use $\\\\ell_{\\\\text{max}} = 4$ for elastic tensors.\\n\\n5.3. Experimental Results\\n\\nAbility to generate tensors adhering to symmetry. We first evaluate the ability of GMTNet to generate tensor predictions that adhere to crystal symmetry. As demonstrated in Sec. 2.2, crystal symmetry constraints result in exact zero elements in dielectric tensors in all crystal systems except the triclinic system. Table 2 shows that invariant MEGNET has no ability to capture this, while equivariant ETGNN can only capture a limited portion of crystal structures in various crystal systems. In contrast, our method achieves 100% success rate in capturing zero elements adhering to crystal symmetry, across various crystal systems.\\n\\nTable 2. Predicting symmetry-constrained zero-valued dielectric tensor elements. Success rate measured by error $< 10^{-5}$. Property labels in the curated dataset achieve 100% success rate.\\n\\n| Crystal System | MEGNET | ETGNN | GMTNet |\\n|----------------|--------|-------|--------|\\n| Cubic          | 0%     | 13.5% | 100%   |\\n| Tetragonal     | 0%     | 1.3%  | 100%   |\\n| Hexa-Trigonal  | 0%     | 2.3%  | 100%   |\\n| Orthorhombic   | 0%     | 0%    | 100%   |\\n| Monoclinic     | 0%     | 6.4%  | 100%   |\\n\\nAdditionally, intrinsic crystal symmetries result in mutually dependent elements in dielectric tensors in certain crystal systems. Table 3 demonstrates that MEGNET has 0% success rate for all systems. ETGNN achieves 100% for cubic systems, but only achieves 55% for the tetragonal system, and even 0% for hexagonal and trigonal systems, while our method again achieves 100% success rate across various crystal systems. We also provide equivariance verification in Appendix A.4 showing that ETGNN and our GMTNet maintain equivariance for tensor predictions while MEGNET breaks this property.\\n\\nTable 3. Capturing the equality of symmetry-constrained mutually dependent dielectric tensor elements. Success rate measured by difference $< 10^{-4}$. Dataset labels achieve 100% success rate.\\n\\n| Crystal System | MEGNET | ETGNN | GMTNet |\\n|----------------|--------|-------|--------|\\n| Cubic          | 0%     | 100%  | 100%   |\\n| Tetragonal     | 0%     | 55.3% | 100%   |\\n| Hexagonal      | 0%     | 0%    | 100%   |\\n| Trigonal       | 0%     | 0%    | 100%   |\\n\\nHigh-quality tensor predictions. The prediction accuracy of different models by Fnorm and error within threshold (EwT) is shown in Table 4. GMTNet achieves 84.5% high-quality dielectric predictions within 25% threshold and achieves 57.1% for a stricter 10% threshold, showing a much better modeling power beyond ETGNN with only 41.6%. Additionally, GMTNet achieves a 3.50 Fnorm across different crystal systems, significantly better than ETGNN with 3.92. We also provide visualization comparison for predicted piezoelectric tensors in Figure 2, as well as dielectric and elastic tensors in Appendix A.4.\\n\\nTable 4. Comparison of accuracy in terms of Fnorm and error within threshold (EwT) on the test set of dielectric tensors.\\n\\n| Model          | Fnorm  | EwT 25% | EwT 10% | EwT 5% |\\n|----------------|--------|---------|---------|--------|\\n| MEGNET         | 4.16   | 74.9%   | 41.6%   | 57.1%  |\\n| ETGNN          | 3.92   | 81.3%   | 41.6%   | 57.1%  |\\n| GMTNet         | 3.50   | 84.5%   | 57.1%   | 27.8%  |\\n\\nTable 5. Prediction accuracy in terms of Fnorm and error within threshold (EwT) on test set for piezoelectric and elastic tensors.\\n\\n| Property       | Mean Fnorm (\u00b1std) | EwT 25% | EwT 10% | EwT 5% |\\n|----------------|-------------------|---------|---------|--------|\\n| Piezo (C/m\u00b2)   | 0.43 \u00b1 3.09       | 49.1%   | 46.3%   | 45.7%  |\\n| Elastic (GPa)  | 0.326 \u00b1 249.3     | 66.1%   | 21.8%   | 7.7%   |\"}"}
{"id": "BOFjRnJ9mX", "page_num": 17, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"The symmetry adjustment operator, \\n\\\\[ 1 \\\\leq i \\\\leq n_r WD^\\\\ell (R_i) \\\\], embeds the structural symmetry information of the crystal input. However, the minor errors in each element are challenging to identify and correct. Fortunately, for specific tensor properties, it is possible to extract symmetry characteristics using defined tolerances, thereby eliminating errors in the symmetry operator.\\n\\nFor instance, consider the symmetry adjustment operator \\n\\\\[ 1 \\\\leq i \\\\leq n_r WD^\\\\ell = 0, 1, 2 \\\\] (\\\\(R_i\\\\)). To extract the equality characteristics of dielectric tensors using tolerance, we first construct three vectors \\n\\\\(v_1 \\\\in \\\\mathbb{R}^3\\\\), \\n\\\\(v_2 \\\\in \\\\mathbb{R}^3\\\\), \\n\\\\(v_3 \\\\in \\\\mathbb{R}^5\\\\) with rotation orders 0, 1, and 2, respectively, each containing distinct values in their elements. The symmetry-adjusted vectors are obtained as:\\n\\n\\\\[ v_{\\\\text{new}1} = 1 \\\\leq i \\\\leq n_r WD^\\\\ell = 0 (R_i) \\\\circ v_1 \\\\],\\n\\n\\\\[ v_{\\\\text{new}2} = 1 \\\\leq i \\\\leq n_r WD^\\\\ell = 1 (R_i) \\\\circ v_2 \\\\],\\n\\n\\\\[ v_{\\\\text{new}3} = 1 \\\\leq i \\\\leq n_r WD^\\\\ell = 2 (R_i) \\\\circ v_3 \\\\].\\n\\nSince dielectric tensors comprise three vectors of rotation orders 0, 1, and 2, the vectors \\\\(v_{\\\\text{new}1}, v_{\\\\text{new}2}, v_{\\\\text{new}3}\\\\) can be transformed into a \\\\(3 \\\\times 3\\\\) dielectric tensor \\\\(\\\\varepsilon\\\\) symmetry. Equality pairs within \\\\(\\\\varepsilon\\\\) symmetry are identified by comparing elements with a tolerance threshold. We find that using 0.01% of the mean value of two elements as the threshold is effective for determining equality in dielectric tensors. Similar approaches can be applied to piezoelectric and elastic tensors, and threshold value \\\\(\\\\varepsilon_{\\\\text{zero}} = 1\\\\) is effective for determining zero elements in piezoelectric and elastic tensors if needed.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 1, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nKeqiang Yan 1\\nAlexandra Saxton 1\\nXiaofeng Qian 1 *\\nXiaoning Qian 1 *\\nShuiwang Ji 1 *\\n\\nAbstract\\nWe consider the prediction of general tensor properties of crystalline materials, including dielectric, piezoelectric, and elastic tensors. A key challenge here is how to make the predictions satisfy the unique tensor equivariance to $O(3)$ group and invariance to crystal space groups. To this end, we propose a General Materials Tensor Network (GMTNet), which is carefully designed to satisfy the required symmetries. To evaluate our method, we curate a dataset and establish evaluation metrics that are tailored to the intricacies of crystal tensor predictions. Experimental results show that our GMTNet not only achieves promising performance on crystal tensors of various orders but also generates predictions fully consistent with the intrinsic crystal symmetries. Our code is publicly available as part of the AIRS library (https://github.com/divelab/AIRS).\\n\\n1. Introduction\\nTensor properties of crystalline materials are fundamental in advancing various technological sectors, leading to significant innovations in device development. These properties span multiple orders, encompassing atomic charge (order 0), atomic force (order 1), dielectric tensor (order 2), piezoelectric tensor (order 3), elastic tensor (order 4), and beyond. Dielectric materials, characterized by dielectric tensors, are crucial in modern technologies ranging from computer memory to sensors and communication circuits (Petousis et al., 2016). Piezoelectric materials, notable for their significant piezoelectric coefficients, find extensive use in actuators, sensors, and energy-harvesting devices (Mahapatra et al., 2021). Materials with higher-order optical tensors play an essential role in developing novel optics and quantum technologies (Xiao et al., 2020; Wang & Qian, 2020).\\n\\nAccurately predicting these tensor properties is key to discovering new crystals with desirable characteristics. First-principles methods, such as density functional theory (DFT), have facilitated the prediction of various properties within an acceptable error margin compared to traditional laboratory experiments (Petousis et al., 2016). However, DFT methods are often resource-intensive, particularly for high-order tensor properties of large crystals, mainly due to the need for self-consistent electronic and ionic relaxation with explicit representations of electronic wavefunctions. To address these challenges, recent advances have leveraged machine learning (ML) techniques (Ying et al., 2021; Liu et al., 2022; Gong et al., 2023), such as descriptor-based Automatminer (Dunn et al., 2020) and graph neural networks like MEGNET (Chen et al., 2019), for efficient prediction of single-value properties invariant to 3D rotations and translations. Nevertheless, these approaches generally overlook the inherent anisotropy of most crystal systems and the tensorial nature of their macroscopic properties, which are not $E(3)$ invariant and take the form of matrices with dimensions $3^n$, where $n$ denotes the tensor order. Concretely, the dielectric tensor $\\\\varepsilon \\\\in \\\\mathbb{R}^{3 \\\\times 3}$ of a crystal plays a pivotal role in determining its response to external electrical fields. Through the relation $D = \\\\varepsilon E$, this tensor dictates the electric displacement vector $D \\\\in \\\\mathbb{R}^3$ when an electric field $E \\\\in \\\\mathbb{R}^3$ is applied. Crucially, the dielectric tensor adapts to the crystal\u2019s orientation. A rotation of the crystal structure by $R \\\\in \\\\mathbb{R}^{3 \\\\times 3}$ with $|R| = \\\\pm 1$ leads to a corresponding rotation of $\\\\varepsilon$, represented as $R \\\\varepsilon R^T$. A similar transformation rule applies to the piezoelectric tensor $\\\\varepsilon \\\\in \\\\mathbb{R}^{3 \\\\times 3 \\\\times 3}$, where $\\\\varepsilon^{ijk} \\\\rightarrow P_{\\\\ell mn} R_i \\\\ell R_j m R_k n e_{\\\\ell mn}$. Ideal ML models should inherently capture this anisotropy and these equivariance rules when predicting crystal tensor properties.\\n\\nFurthermore, the intrinsic symmetries of crystals significantly influence their tensor properties. Different crystal systems exhibit unique tensor characteristics, determined by their crystal class or space group. For instance, crystals in the cubic system possess dielectric tensors with only non-zero diagonal elements that are identical ($\\\\varepsilon_{xx} = \\\\varepsilon_{yy} = \\\\varepsilon_{zz}$), and zero for off-diagonal elements ($\\\\varepsilon_{ij} = 0$ for $i \\\\neq j$).\"}"}
{"id": "BOFjRnJ9mX", "page_num": 2, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"where a crystal structure is characterized by a unit cell \\\\( A(2022) \\\\), to address these challenges, our work focuses on the pre-vectors for each atom and its replicas. To address these challenges, our work focuses on the pre-vectors representing the repeating patterns of the unit cell \\\\( M \\\\) crystal in three-dimensional space. The infinite structure of a given lattice matrix \\\\( P \\\\) denotes the positions of atoms and their infinite replicates in the 3D space, and \\\\( \\\\hat{P} \\\\) corresponds to the feature \\\\( n \\\\) dimensional feature vectors of \\\\( n \\\\) atoms within the unit \\\\( L \\\\) and \\\\( P \\\\) lattice matrix, respectively. It is mathematically represented by three-dimensional space along three periodic lattice vectors, \\\\( \\\\ell \\\\), \\\\( i \\\\), and \\\\( k \\\\). Alternatively, \\\\( n \\\\) elements of the \\\\( \\\\hat{a} \\\\times \\\\hat{a} \\\\) matrix are non-zero. These tensors play pivotal roles in understanding and predicting the mechanical and electrical behavior of crystals. Mathematically, these transformations can be represented as a rotation-reflection matrix \\\\( R \\\\), which encapsulate the spatial symmetries inherent in crystal structures back to itself, albeit with a reindexed arrangement. \\n\\nCrystal space group transformations \\\\( O \\\\) on three crystal tensor properties; namely dielectric, piezoelectric, and elastic tensors. The contributions of this work are summarized as follows. (1) We propose a general equivariant graph neural network that captures the anisotropy nature and the unique equivariance of crystal tensors, along with establishing robust evaluation metrics specifically tailored for ML-based predictions of general tensors, along with dielectric, piezoelectric, and elastic tensors. The contributions focus on three crystal tensor properties including dielectric, piezoelectric, and elastic tensors. The contributions are naturally defined as the responses of materials under different conditions. In general, the physical properties, when applying an external strain tensor to a crystal structure, from the transformed dielectric tensor after rotation, we confirm that the transformed dielectric tensor after rotation transformation. Specifically, the electric field \\\\( \\\\mathbf{E} \\\\) and the resultant electric displacement field \\\\( \\\\mathbf{D} \\\\) transform to \\\\( \\\\mathbf{RD} \\\\), and the electric displacement field \\\\( \\\\mathbf{D} \\\\) correlates the externally applied electric field \\\\( \\\\mathbf{E} \\\\). A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction.\\n\\nBy Neumann's Principle, a fundamental tenet in crystal physics, the symmetry observed in any physical property is depicted by \\\\( \\\\sigma \\\\). Consequently, this change can be mathematically described as rearranging this equation, we obtain the anisotropic nature and the unique equivariance of crystal tensors. For instance, the piezoelectric tensor \\\\( \\\\epsilon \\\\) is\\n\\n\\\\[\\n\\\\epsilon_{ijk} = \\\\sum_{r,s} \\\\epsilon_{pqrs} R_{pqr} \\\\epsilon_{rs}\\\\]\\n\\nwhere \\\\( \\\\epsilon_{pqrs} \\\\) is the piezoelectric tensor within the material, formulated as\\n\\n\\\\[\\n\\\\epsilon_{ijkl} = \\\\sum_{r,s} \\\\epsilon_{pqrs} R_{pqr} \\\\epsilon_{rs}\\\\]\\n\\nThis transformation principle extends similarly to other crystal tensors. For instance, the piezoelectric tensor follows the transformation \\\\( \\\\mathbf{D} = \\\\mathbf{RD} \\\\), and the elastic tensor follows the transformation \\\\( \\\\mathbf{\u03c3} = \\\\mathbf{R\u03c3} \\\\).\\n\\nThe piezoelectric tensor \\\\( \\\\epsilon \\\\) and the elastic tensor are defined as\\n\\n\\\\[\\n\\\\epsilon_{ijkl} = \\\\sum_{r,s} \\\\epsilon_{pqrs} R_{pqr} \\\\epsilon_{rs}\\\\]\\n\\nThe piezoelectric tensor \\\\( \\\\epsilon \\\\) and the elastic tensor follow the transformation\\n\\n\\\\[\\n\\\\sigma_{ijkl} = \\\\sum_{r,s} \\\\sigma_{pqrs} R_{pqr} \\\\sigma_{rs}\\\\]\\n\\nLastly, the elastic tensor and the piezoelectric tensor transform to \\\\( \\\\mathbf{\u03c3} = \\\\mathbf{R\u03c3} \\\\) and \\\\( \\\\mathbf{D} = \\\\mathbf{RD} \\\\), respectively. This leads to a new relationship as\\n\\n\\\\[\\n\\\\epsilon_{ij} = \\\\sum_{r,s} \\\\epsilon_{pqrs} R_{pqr} \\\\epsilon_{rs}\\\\]\\n\\nThese tensors play pivotal roles in understanding and predicting the mechanical and electrical behavior of crystals. Mathematically, these transformations can be represented as a rotation-reflection matrix \\\\( R \\\\), which encapsulate the spatial symmetries inherent in crystal structures back to itself, albeit with a reindexed arrangement.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 3, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"A Space Group Symmetry Informed Network for O(3) Equivariant Crystal Tensor Prediction\\n\\nCrystal Structures\\nIntrinsic Symmetry\\nSymmetry-informed crystal graph\\nCrystal-level high rotation order feature extraction\\nNode invariant feature updating\\nEquivariant message passing\\nCrystal graph construction\\nEquivariant crystal-level feature extraction\\nNode and edge feature embeddings\\nOrder 2: Dielectric\\nOrder 3: Piezoelectric\\nOrder 4: Elastic\\nEquivariant tensor property prediction\\nSymmetry Enforcement\\nElastic\\nPiezoelectric\\nCrystal Structures\\nCubic\\nHexagonal\\nTetragonal\\nOrthorhombic\\nMonoclinic\\nTriclinic\\n\\nFigure 1. Overview of GMTNet. GMTNet takes crystal structures represented as\\ninput to predict crystal tensor properties of various orders. It comprises four modules: symmetry-informed crystal graph construction, crystal-level equivariant feature extraction, equivariant tensor property prediction, and symmetry enforcement. GMTNet is carefully designed to generate tensor predictions that adhere to the intrinsic symmetries of the input crystal structures. We also include visualizations of crystal structures and tensors with different orders belonging to various crystal systems. These visualizations, generated using matplotlib (Hunter, 2007) and MTEX (Bachmann et al., 2010), illustrate the correlation between crystal symmetries and tensor property complexities.\\n\\nIn summary, crystal tensor properties change accordingly when rotating or reflecting the crystal structure and have symmetry constraints, e.g., \\\\( \\\\mathbf{\\\\varepsilon} = R_i \\\\mathbf{\\\\varepsilon} R_i^T \\\\) with \\\\( R_i \\\\) in the crystal's space group for dielectric tensors. These constraints are the direct consequence of symmetry, which is not only true for all crystal tensor properties, but also critical to be obeyed when developing ML-based tensor property predictions.\"}"}
{"id": "BOFjRnJ9mX", "page_num": 4, "content": "{\"primary_language\":\"en\",\"is_rotation_valid\":true,\"rotation_correction\":0,\"is_table\":false,\"is_diagram\":false,\"natural_text\":\"The magnitude is further mapped to a potential-like term, \\\\( \\\\text{||\u03bd||} \\\\), with edge features capturing the relative magnitude of \\\\( k \\\\). We create node type features and edge feature embedding \\\\( \\\\nu \\\\) based on \\\\( \\\\text{CGCNN} \\\\) (Xie & Grossman, 2018) feature representations. The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( k \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\). The neighbors of each node are determined within a radius \\\\( r \\\\) of \\\\( p \\\\), established by the distance to the \\\\( | \u03bd | \\\\)-th nearest neighbor. Edges are formed between nodes \\\\( ji \\\\) and positions \\\\( p \\\\). If there are multiple positions of node \\\\( ji \\\\) within the radius, multiple edges \\\\( ji \\\\rightarrow k \\\\) are associated with node feature \\\\( | \u03bd | \\\\) and positions \\\\( p \\\\).\"}"}
